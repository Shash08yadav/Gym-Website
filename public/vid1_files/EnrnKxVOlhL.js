;/*FB_PKG_DELIM*/

__d("WAWebDBRevokeInviteV4",["WAWebApiGroupInviteV4Store","WAWebBackendApi","WAWebDBMsgUtils","WAWebDBProcessMessage","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b,c,d){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){a=(yield d("WAWebApiGroupInviteV4Store").revokeGroupInvites(a,b,c,e));b=(a==null?void 0:a.map(function(a){return a.id}))||[];c=(yield d("WAWebDBMsgUtils").getMsgsByMsgKey(b,function(a){a.inviteCodeExp="0"}));for(e of c)d("WAWebBackendApi").frontendFireAndForget("expireGroupInviteV4",{inviteMsgId:e.id}),d("WAWebDBProcessMessage").updateExistingMessages([e],e.id.remote)});return h.apply(this,arguments)}g.revokeGroupInviteV4=a}),98);
__d("WAWebOnlineDanglingReceipts",["Promise","WALogger","WATimeUtils","WAWebABProps","WAWebCommsSendPing","WAWebNetworkStatus","WAWebSchemaDanglingReceipt","WAWebSendReceiptJobCommon","WAWebWamOfflineResumeReporter","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[online-preacks]: clearOrFlushOnlineDanglingReceipts: flush "," receipts"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[online-preacks]: clearOrFlushOnlineDanglingReceipts: flush due to offline."]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[online-preacks]: clearOrFlushOnlineDanglingReceipts: failed to send ping"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[online-preacks]: clearOrFlushOnlineDanglingReceipts: starting clean receipts"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[online-preacks]: clearOrFlushOnlineDanglingReceipts: starting sending ping"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[online-preacks]: skip due to empty receipts."]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[online-preacks]: start to clean online dangling receipts due to timeout"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["[online-preacks]: clearOnlineDanglingReceipts: starting clean receipts"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["[online-preacks]: clearOnlineDanglingReceipts: starting sending ping"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["[online-preacks]: clearOnlineDanglingReceipts: skip due to empty receipts."]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["[online-preacks]: clearOnlineDanglingReceipts: skip due to offline."]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["[online-preacks]: sending online dangling grouped receipts: ",""]);t=function(){return a};return a}var u=new Map(),v=null,w=120*1e3;function a(a,b,c){u.has(a)||u.set(a,new Map());a=u.get(a);(a==null?void 0:a.has(b))||(a==null?void 0:a.set(b,[]));a==null?void 0:(a=a.get(b))==null?void 0:a.push(c);v||(v=self.setTimeout(function(){void B(),v=null},w))}function x(){return u.size>0&&d("WAWebABProps").getABPropConfigValue("web_pre_acks_m3_receipts_enabled")}function e(){return y.apply(this,arguments)}function y(){y=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=String(d("WATimeUtils").unixTime()),c=0,e=Array.from(u.keys()).map(function(b){var e=u.get(b);if(!e)return;e.forEach(function(a){c+=a.length});d("WALogger").LOG(t(),e.size);return d("WAWebSendReceiptJobCommon").sendAggregateReceipts({to:b,type:d("WAWebSendReceiptJobCommon").RECEIPT_TYPE.DELIVERY,t:a,groupedReceipt:e})});yield (h||(h=b("Promise"))).all(e);d("WAWebWamOfflineResumeReporter").OfflineResumeReporter.logOfflinePreackCount(c,!0);void z()});return y.apply(this,arguments)}function z(){return A.apply(this,arguments)}function A(){A=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!c("WAWebNetworkStatus").online){d("WALogger").LOG(s());return(h||(h=b("Promise"))).resolve()}if(u.size===0){d("WALogger").LOG(r());return(h||(h=b("Promise"))).resolve()}d("WALogger").LOG(q());yield d("WAWebCommsSendPing").blockSendPing();d("WALogger").LOG(p());u.clear()});return A.apply(this,arguments)}function B(){return C.apply(this,arguments)}function C(){C=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WALogger").LOG(o());if(u.size===0){d("WALogger").LOG(n());return(h||(h=b("Promise"))).resolve()}if(!c("WAWebNetworkStatus").online)return D();d("WALogger").LOG(m());try{yield d("WAWebCommsSendPing").blockSendPing(),d("WALogger").LOG(l()),u.clear()}catch(a){d("WALogger").LOG(k()),void D()}});return C.apply(this,arguments)}function D(){return E.apply(this,arguments)}function E(){E=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!x()||!d("WAWebABProps").getABPropConfigValue("web_pre_acks_m3_enabled"))return;d("WALogger").LOG(j());var a=[];u.forEach(function(b,c){b.forEach(function(b,d){b.forEach(function(b){a.push({from:String(c),author:String(d),externalId:b})})})});a.length>0&&(d("WALogger").LOG(i(),a.length),yield d("WAWebSchemaDanglingReceipt").getTable().create({receipts:a,acks:[]}),u.clear())});return E.apply(this,arguments)}g.addOnlineDanglingReceipts=a;g.hasOnlineDanglingReceipts=x;g.sendAndClearOnlineDanglingReceipts=e}),98);
__d("WAWebWamEnumApplicationState",[],(function(a,b,c,d,e,f){a=Object.freeze({FOREGROUND:1,BACKGROUND:2});f.APPLICATION_STATE=a}),66);
__d("WAWebWamEnumProjectCode",[],(function(a,b,c,d,e,f){a=Object.freeze({DIT:1,DIRECTORY_SEARCH:2});f.PROJECT_CODE=a}),66);
__d("WAWebWamEnumSignCredentialResult",[],(function(a,b,c,d,e,f){a=Object.freeze({SUCCESS:1,ERROR_BAD_REQUEST:2,ERROR_SERVER:3,ERROR_OTHER:4,ERROR_CLIENT_NETWORK:5});f.SIGN_CREDENTIAL_RESULT=a}),66);
__d("WAWebSignCredentialWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumApplicationState","WAWebWamEnumProjectCode","WAWebWamEnumSignCredentialResult"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({SignCredential:[2242,{applicationState:[6,d("WAWebWamEnumApplicationState").APPLICATION_STATE],isFromWameta:[8,a.TYPES.BOOLEAN],overallT:[4,a.TYPES.TIMER],projectCode:[7,d("WAWebWamEnumProjectCode").PROJECT_CODE],retryCount:[2,a.TYPES.INTEGER],signCredentialResult:[1,d("WAWebWamEnumSignCredentialResult").SIGN_CREDENTIAL_RESULT],signCredentialT:[3,a.TYPES.TIMER],waConnectedToChatd:[5,a.TYPES.BOOLEAN]},[1,1,1],"regular"]},{SignCredential:[]});g.SignCredentialWamEvent=b}),98);
__d("WAWamPrivateStatsToken",["WACryptoEd25519","WACryptoPrimitives"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("WACryptoEd25519").runInAllocationScope(function(){var c,e=(c=d("WACryptoEd25519")).p3Element(),f=c.allocate(Uint8Array,32);f.set(b);h(f);d("WACryptoPrimitives").lowlevel.scalarbase(e,f);f=c.hashToPoint(a);var g=d("WACryptoPrimitives").lowlevel.add;g(f,e);g=new Uint8Array(32);c.pack(g,f);return g})}function b(a,b,c){return d("WACryptoEd25519").runInAllocationScope(function(){var e=d("WACryptoEd25519").p3Element();if(d("WACryptoEd25519").unpack(e,a))return null;var f=d("WACryptoEd25519").p3Element();if(d("WACryptoEd25519").unpackneg(f,c)!==0)return null;var g=d("WACryptoEd25519").allocate(Uint8Array,32);g.set(b);h(g);var i=d("WACryptoEd25519").p3Element();d("WACryptoPrimitives").lowlevel.scalarmult(i,f,g);f=d("WACryptoPrimitives").lowlevel.add;f(e,i);g=new Uint8Array(32);d("WACryptoEd25519").pack(g,e);return g})}function h(a){a[0]&=248,a[31]&=127,a[31]|=64}g.blindToken=a;g.unblindToken=b}),98);
__d("WAWamChannelManager",[],(function(a,b,c,d,e,f){"use strict";var g=function(){function a(){this.$1=new Map(),this.$2=new Map()}var b=a.prototype;b.getChannelInitialized=function(a){return this.$2.get(a)||!1};b.setChannelInitialized=function(a){this.$2.set(a,!0)};b.isSinkBusy=function(a){return this.$1.get(a)||!1};b.setSinkBusy=function(a,b){this.$1.set(a,b)};b.close=function(){var a=this;this.$1.forEach(function(b,c){a.$1.set(c,!1)});this.$2.forEach(function(b,c){a.$2.set(c,!1)})};return a}(),h;function a(){h==null&&(h=new g());return h}function b(){h!=null&&h.close()}f.getChannelManager=a;f.closeChannelManager=b}),66);
__d("WAWamTypes",[],(function(a,b,c,d,e,f){"use strict";a={INT:0,BOOL:1,STRING:2,FLOAT:3};f.TYPES=a}),66);
__d("WAWamBuffer",["WABinary","WAErr","WAWamTypes"],(function(a,b,c,d,e,f,g){"use strict";var h=5,i=47,j=0,k=2,l=1,m=2,n=0,o=4,p=8;e=function(){function a(a,b,c,e){var f=this;this.$5=!1;this.$6=!1;var g=new(d("WABinary").Binary)(void 0,!0);g.writeString("WAM");g.writeUint8(h);g.writeUint8(b);g.writeUint16(c);switch(a){case"regular":g.writeUint8(j);break;default:a,g.writeUint8(k)}this.$1=a;this.$2=g;this.$3=c;this.$4=b;e.forEach(function(a,b){return void f.writeGlobal(b,a)})}var b=a.prototype;b.writeGlobal=function(a,b){if(b==null){t(this.$2,a,n);return}if(typeof b==="string")s(this.$2,a,n,b);else if(typeof b==="number")q(this.$2,a,n,b);else if(typeof b==="boolean")q(this.$2,a,n,b?1:0);else throw c("WAErr")("Incorrect value type "+typeof b)};b.writeEvent=function(a,b,c,e){var f=this.$2;q(f,i,n,Math.floor(a/1e3));a=u(c);var g=a===-1?l|o:l;q(f,b,g,e);for(b=0;b<=a;b+=3){g=c[b+2];if(g!=null){e=c[b];var h=c[b+1],j=b===a?m|o:m;h===d("WAWamTypes").TYPES.INT?q(f,e,j,g):h===d("WAWamTypes").TYPES.BOOL?q(f,e,j,g?1:0):h===d("WAWamTypes").TYPES.STRING?s(f,e,j,g):r(f,e,j,g)}}this.$6=!0};b.getKey=function(){return{streamId:this.$4,sequenceNumber:this.$3,channel:this.$1}};b.getSize=function(){return this.$2.size()};b.peek=function(){return this.$2.peek(function(a){return a.readByteArray()})};b.getBuffer__INTERNAL=function(){return this.$2};b.isFinalized=function(){return this.$5};b.finalize=function(){this.$5=!0};b.hasEvents=function(){return this.$6};return a}();function q(a,b,c,d){d===0?t(a,b,c|1<<4):d===1?t(a,b,c|2<<4):-128<=d&&d<128?(t(a,b,c|3<<4),a.writeInt8(d)):-32768<=d&&d<32768?(t(a,b,c|4<<4),a.writeInt16(d)):-2147483648<=d&&d<2147483648?(t(a,b,c|5<<4),a.writeInt32(d)):(t(a,b,c|6<<4),a.writeInt64(d))}function r(a,b,c,d){t(a,b,c|7<<4),a.writeFloat64(d)}function s(a,b,c,e){var f=d("WABinary").numUtf8Bytes(e);f<256?(t(a,b,c|8<<4),a.writeUint8(f)):f<65536?(t(a,b,c|9<<4),a.writeUint16(f)):(t(a,b,c|10<<4),a.writeUint32(f));a.writeString(e)}function t(a,b,c){b<256?(a.writeUint8(c),a.writeUint8(b)):(a.writeUint8(c|p),a.writeUint16(b))}function u(a){var b=-1;for(var c=0;c<a.length;c+=3)a[c+2]!=null&&(b=c);return b}function a(a){var b=u(a);for(var c=0;c<=b;c+=3){var e=a[c+2];if(e!=null){var f=a[c+1];if(f===d("WAWamTypes").TYPES.INT&&isNaN(e))return!1}}return!0}function b(a){return typeof a==="number"?!isNaN(a):!0}g.WamBuffer=e;g.canWriteEvent=a;g.canWriteGlobal=b}),98);
__d("WAWam",["Promise","WALogger","WAPromiseEach","WAShiftTimer","WAWamBuffer"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["WAM: Tried to set private stats ids on a non-private channel"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Skipping putting buffer to sink, as it does not contain any events"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["A WAM event in channel "," was dropped before serialization. Event correct: ",", pending attributes correct: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["A WAM event in channel private was dropped before serialization. Reason: missing psIdIntValue in the event payload"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["WAM: Tried to create a private buffer without setting private stats id"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["WAM: Tried to create a private buffer without setting private stats ids"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["WAM: Sequence number generator not initialised for channel ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["WAM: Initialized with stream id ",""]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["WAM: Failed to initialize already initialized WAM"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["WAM: Enqueued "," attribute keys for update"]);r=function(){return a};return a}var s=64*1024,t=5*60*1e3,u=3e3,v=1,w=2,x=6005;a=113760892;var y=0,z="none",A={putBuffer:function(a,c,d){return(h||(h=b("Promise"))).resolve()}};c=function(){function a(a){var b=this;this.$2=[];this.$3=new Map();this.$4=!1;this.$5=new Map();this.$8=-1;this.$9=A;this.$10=null;this.deinitialize=function(){b.$4=!1,b.$2=[],b.$3.clear(),b.$5=new Map(),b.$8=-1,b.$9=A,b.serializePending.cancel(),b.finalizeBuffers.cancel()};this.enqueueEvent=function(a,c,d,e,f,g){var h=v;b.$2.push({type:h,id:a,commitTime:c,psIdIntValue:d,weight:f,fields:e,resolve:g});b.$4&&b.serializePending.onOrBefore(u)};this.enqueueAttributesUpdate=function(a){var c={type:w,delta:[]};a.forEach(function(a,b){if(a===void 0)return;c.delta.push([b,a])});c.delta.length>0&&(d("WALogger").LOG(r(),c.delta.length),b.$2.push(c))};this.finalizeBuffers=new(d("WAShiftTimer").ShiftTimer)(function(){b.finalizeBuffers__INTERNAL()});this.serializePending=new(d("WAShiftTimer").ShiftTimer)(function(){b.serializePending__INTERNAL()});this.forceSerializePending=function(){if(!b.$4)return;b.$11()&&b.serializePending.forceRunNow()};this.$1=a}var b=a.prototype;b.initialize=function(a,b,c,e){if(this.$4){d("WALogger").ERROR(q()).sendLogs("wam-initialize");return}this.$7=e;this.$8=a;this.$9=c;this.$10=b;this.$11()&&this.serializePending.forceRunNow();this.$4=!0;d("WALogger").LOG(p(),this.$8)};b.finalizeBuffers__INTERNAL=function(){this.$5.forEach(function(a){a.finalize()}),this.$5.size>0&&this.serializePending.onOrBefore(u)};b.$12=function(a){var b;if(!((b=this.$7)==null?void 0:b.multipleSequences))return"regular";return a===y?"null-psid":a};b.$13=function(a){var b=this.$5.get(a);if(b)return b;var c=this.$12(a);if(this.$10==null){d("WALogger").ERROR(o(),this.$1).sendLogs("wam-serializePending");return}c=this.$10(c);b=new(d("WAWamBuffer").WamBuffer)(this.$1,this.$8,c,this.$3);this.$5.set(a,b);if(a!=="regular"){a;if(this.$6==null)d("WALogger").ERROR(n()).sendLogs("wam-serializePending");else{c=a===y?z:this.$6.get(a);c==null?d("WALogger").ERROR(m()).sendLogs("wam-serializePending"):b.writeGlobal(x,c)}}return b};b.serializePending__INTERNAL=function(){var a=this,b=[];this.finalizeBuffers.onOrBefore(t);var c=new Map(),e=-1;this.$2.forEach(function(f,g){if(f.type===v){var h=!0;c.forEach(function(a){d("WAWamBuffer").canWriteGlobal(a)||(h=!1)});var i=d("WAWamBuffer").canWriteEvent(f.fields);if(i&&h){var j;a.$1==="regular"?j=a.$13("regular"):(a.$1,f.psIdIntValue==null?d("WALogger").ERROR(l()).sendLogs("wam-serializePending"):j=a.$13(f.psIdIntValue));j!=null&&(c.forEach(function(c,b){var d=a.$3.get(b);(d===void 0||d!==c)&&(a.$5.forEach(function(a){return a.writeGlobal(b,c)}),a.$3.set(b,c))}),c.clear(),j.writeEvent(f.commitTime,f.id,f.fields,f.weight))}else d("WALogger").WARN(k(),a.$1,i,h).devConsole("pending attributes",c,"pending event action",f);f.resolve!=null&&b.push(f.resolve);e=g}else{f.type;for(i=0;i<f.delta.length;++i){g=f.delta[i];var m=g[0];g=g[1];c.set(m,g)}}});var f=!1;this.$5.forEach(function(a){(a.isFinalized()||a.getSize()>s)&&(f=!0)});var g=[];this.$5.forEach(function(b,c){b.hasEvents()?g.push([b.getKey(),b.peek(),a.$12(c)]):d("WALogger").WARN(j())});var h=d("WAPromiseEach").promiseEach(g,function(b){var c=b[0],d=b[1];b=b[2];return a.$9.putBuffer(c,d,f,b)}).then(function(){b.forEach(function(a){return void a()})});this.$2=this.$2.slice(e+1);f&&(this.$5=new Map(),this.finalizeBuffers.cancel());return h};b.$11=function(){return this.$2.length>0&&this.$2.some(function(a){return a.type===v})};b.isInitialized=function(){return this.$4};b.getStreamId=function(){return this.$8};b.getPendingActions=function(){return this.$2};b.getBuffers__INTERNAL=function(){return this.$5};b.getGlobals__INTERNAL=function(){return this.$3};b.setGlobals__INTERNAL=function(a){this.$3=a};b.getSink__INTERNAL=function(){return this.$9};b.updatePrivateStatsIds=function(a){if(this.$1!=="private"){d("WALogger").ERROR(i()).sendLogs("wam-updatePrivateStatsIds");return}this.$6=a};return a}();g.PRIVATE_STATS_DEFAULT_PS_ID_KEY_HASH_INT=a;g.Wam=c}),98);
__d("WAWamManager",["WALogger","WAWam"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["WamManager: Deinitializing WAM Channel ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["WAM instance for channel "," has already been initialized"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["SequenceNumberGenerator::initializeForChannel: Incorrect combination of parameters: "," "," ",""]);j=function(){return a};return a}var k=65535,l=function(){function a(a){this.$1=new Map(),this.$2=a}var b=a.prototype;b.$3=function(a,b){b==null||b===0?this.$1.set(a,"uninitialized"):b<0?this.$1.set(a,"uninitialized"):this.$1.set(a,b)};b.getSequenceNumber__INTERNAL=function(){return this.$1};b.initializeForChannel=function(a,b){var c=this;b.forEach(function(b,e){var f;if(a==="regular"&&e==="regular")c.$3(e,b);else if(a==="private"&&e!=="regular")c.$3(e,b);else if(a==="private"&&!((f=c.$2)==null?void 0:f.multipleSequences))c.$3(e,b);else{d("WALogger").ERROR(j(),a,e,(f=c.$2)==null?void 0:f.multipleSequences)}})};b.next=function(a){var b=this.$1.get(a),c;b==null||b==="uninitialized"?c=1:(c=b+1,c>k&&(c=1));this.$1.set(a,c);return c};return a}();a=function(){function a(){this.$1=new Map(),this.$2=null}var b=a.prototype;b.getWamInstance=function(a){var b=this.$1.get(a);b||(b=new(d("WAWam").Wam)(a),this.$1.set(a,b));return b};b.initialize=function(a,b,c,e,f){var g=this.getWamInstance(a);if(g.isInitialized()){d("WALogger").WARN(i(),a);return}this.$2==null&&(this.$2=new l(f));var h=this.$2;this.$2.initializeForChannel(a,c);g.initialize(b,function(a){return h.next(a)},e,f)};b.deinitialize=function(){this.$1.forEach(function(a,b){a.isInitialized()&&(d("WALogger").LOG(h(),b),a.deinitialize())}),this.$2=null};b.enqueueEvent=function(a,b,c,d,e,f,g){a=this.getWamInstance(a);a.enqueueEvent(b,c,d,e,f,g)};b.enqueueAttributesUpdate=function(a,b){a=this.getWamInstance(a);a.enqueueAttributesUpdate(b)};b.updatePrivateStatsIds=function(a){var b=this.getWamInstance("private");b.updatePrivateStatsIds(a)};b.forceFlushBuffers=function(){this.$1.forEach(function(a){a.forceSerializePending()})};b.rotateBuffers=function(){this.$1.forEach(function(a){a.finalizeBuffers.forceRunNow()})};b.getSequenceNumberGenerator__INTERNAL=function(){return this.$2};return a}();g.WamManager=a}),98);
__d("WAWamUtils",["WABase64","WAErr","WALogger","WAWamTypes"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["logAttributes WAM channel is not an array"]);j=function(){return a};return a}var k=(h={},h[(i=d("WAWamTypes")).TYPES.INT]="number",h[i.TYPES.FLOAT]="number",h[i.TYPES.STRING]="string",h[i.TYPES.BOOL]="boolean",h);function a(a,b){if(b==null||b.length===0)return a;var c=new Map();for(var d=0;d<a.length;d+=3){var e=a[d];c.set(e,d)}for(e=0;e<b.length;++e){d=b[e];var f=d[0],g=d[1];d=d[2];if(d==null)continue;var h=c.get(f);if(h!=null){var i=a[h+2];if(i!==void 0)continue}i=k[g];i===typeof d&&(h==null?(c.set(f,a.length),a.push(f,g,d)):a[h+2]=d)}return a}function b(a){var b=new Map(),e=new Map();for(var f=0;f<a.length;f+=4){var g=a[f],h=a[f+1],i=a[f+2],k=a[f+3];if(i===d("WAWamTypes").TYPES.FLOAT)throw c("WAErr")("Float attributes are currently not supported in runtime");if(!Array.isArray(g)){d("WALogger").ERROR(j()).sendLogs("wam-log-attributes");return}g.includes("regular")&&b.set(h,k);g.includes("private")&&e.set(h,k)}return{deltaRegular:b,deltaPrivate:e}}function e(a,b){var c=[];b.forEach(function(b){var e=b.channel;if(e==null){if(a!=="regular")return}else if(e!==a)return;if(b.finished){e=new Uint8Array(d("WABase64").decodeB64(b.buffer));b=b.key;c.push({key:b,content:e})}});return c}function l(a){return JSON.stringify([a.streamId,a.sequenceNumber,a.channel])}function f(a,b,c,e,f){var g=l(a);return{bufferKey:g,meta:{streamId:a.streamId,sequenceNumber:a.sequenceNumber},bufferRow:{key:g,channel:b,streamId:c,buffer:d("WABase64").encodeB64(e),finished:f}}}function m(a){var b=null;a&&(b=a.sequenceNumber);return b}g.appendRawFields=a;g.getDeltaFromAttributes=b;g.getFinishedBuffers=e;g.asBufferEntry=f;g.getSequenceNumber=m}),98);
__d("WAWamEntrypoint",["Promise","WALogger","WAWamManager","WAWamUtils"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["wamEntrypoint: logAttributes"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["wamEntrypoint: logAsync"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["wamEntrypoint: log"]);k=function(){return a};return a}var l=1,m=!1,n=null;function o(){n||(n=new(d("WAWamManager").WamManager)());return n}function a(){m=!0}function c(a,b,c,d,e){o().initialize(c,a,b,d,e)}function e(){o().deinitialize()}function f(a,b,c,e,f,g,h){g===void 0&&(g=l);var i=Date.now();m&&h!=null&&d("WALogger").DEV(k()).devConsole(babelHelpers["extends"]({},h,{id:b,arrayFields:e,rawFields:f,weight:g}));o().enqueueEvent(a,b,i,c,d("WAWamUtils").appendRawFields(e,f),g)}function p(a,c,e,f,g,i,k){i===void 0&&(i=l);var n=Date.now();m&&k!=null&&d("WALogger").DEV(j()).devConsole(babelHelpers["extends"]({},k,{id:c,arrayFields:f,rawFields:g,weight:i}));return new(h||(h=b("Promise")))(function(b){o().enqueueEvent(a,c,n,e,d("WAWamUtils").appendRawFields(f,g),i,b)})}function q(a,b){var c=d("WAWamUtils").getDeltaFromAttributes(a);if(c==null)return;var e=c.deltaRegular;c=c.deltaPrivate;m&&b!=null&&d("WALogger").DEV(i()).devConsole(babelHelpers["extends"]({},b,{attributes:a,deltaRegular:e,deltaPrivate:c}));e.size>0&&o().enqueueAttributesUpdate("regular",e);c.size>0&&o().enqueueAttributesUpdate("private",c)}function r(a){o().updatePrivateStatsIds(a)}function s(){o().forceFlushBuffers()}function t(){o().rotateBuffers()}g.enableDebugMode=a;g.initializeWAM=c;g.deinitializeWAM=e;g.log=f;g.logAsync=p;g.logAttributes=q;g.updatePrivateStatsIds=r;g.forceFlushBuffers=s;g.rotateBuffers=t}),98);
__d("WAWamStorage",["Promise","WAErr","WALogger","WATimeUtils","WAWamChannelManager","WAWamEntrypoint","WAWamUtils"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["The private stats token was redeemed maximum number of time. The client shall re-issue a new one"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["The private stats token expired. The client shall re-issue a new one"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["WamStorage: Buffer "," is scheduled for send"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["WamStorage: Successfully put buffer "," to sink"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["WamStorage: Sink flush did not happen within timeout, buffer is not saved"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["startWamStorage: called again"]);n=function(){return a};return a}var o=null,p=null;function q(a){if(p)return p;else throw c("WAErr")("WamStorage::"+a+" called before startWamStorage")}function a(a){p==null?p=a:d("WALogger").WARN(n()).sendLogs("startWamStorage")}function e(){d("WAWamEntrypoint").deinitializeWAM(),d("WAWamChannelManager").closeChannelManager(),p=null,o=null}function f(e,f,g,i){var a=q("initializeWAMSink"),j=d("WAWamChannelManager").getChannelManager();if(j.getChannelInitialized(f))return(h||(h=b("Promise"))).resolve();j.setChannelInitialized(f);var n=a.getStreamId(e),r={putBuffer:function(c,e,i,o){if(j.isSinkBusy(f)){d("WALogger").WARN(m());return(h||(h=b("Promise"))).resolve()}j.setSinkBusy(f,!0);e=d("WAWamUtils").asBufferEntry(c,f,n,e,i);var p=e.bufferKey,q=e.meta;e=e.bufferRow;return a.saveBuffer(q,e,o).then(function(){var a=[c.streamId,c.sequenceNumber];d("WALogger").LOG(l(),a);i&&(g(),d("WALogger").LOG(k(),p))})["finally"](function(){j.setSinkBusy(f,!1)})}};o==null&&(o=a.finishBuffer(n));return o.then(function(){if(a.getStartingSequenceNumbers){a.getStartingSequenceRow;return a.getStartingSequenceNumbers(f,n)}else{a.getStartingSequenceRow;if(i==null?void 0:i.multipleSequences)throw c("WAErr")("getStartingSequenceRow must not used when enabling support for multiple sequences");return a.getStartingSequenceRow(n).then(function(a){a=d("WAWamUtils").getSequenceNumber(a);var b=new Map();b.set("regular",a);return b})}}).then(function(b){d("WAWamEntrypoint").initializeWAM(n,b,f,r,i),f==="private"&&a.updatePrivateStatsIds&&a.updatePrivateStatsIds().then(d("WAWamEntrypoint").updatePrivateStatsIds)})}function r(a){return q("getFinishedStreamBuffers").getBuffers().then(function(b){return d("WAWamUtils").getFinishedBuffers(a,b)})}var s=64,t=function(a,b){var c=(b==null?void 0:b.maxRedeemCount)!=null&&b.maxRedeemCount!==0?b.maxRedeemCount:s;b=(b==null?void 0:b.maxExpirySeconds)!=null&&b.maxExpirySeconds!==0?b.maxExpirySeconds:d("WATimeUtils").DAY_SECONDS;c={maxRedeemCount:c,maxExpirySeconds:b};if(!d("WATimeUtils").happenedWithin(a.creationTs,c.maxExpirySeconds)){d("WALogger").LOG(j());return!1}if(a.redeemCount>=c.maxRedeemCount){d("WALogger").LOG(i());return!1}return!0};function u(){var a=q("getPrivateStatsToken");if(!a.redeemPrivateStatsToken)throw c("WAErr")("redeemPrivateStatsToken not implemented for WAM DB");return a.redeemPrivateStatsToken(t)}function v(b){var a=q("savePrivateStatsToken");if(!a.savePrivateStatsToken)throw c("WAErr")("savePrivateStatsToken not implemented for WAM DB");return a.savePrivateStatsToken(b)}function w(){var a=q("privateStatsKillSwitchGetBlockedToken");if(!a.privateStatsKillSwitchGetBlockedToken)throw c("WAErr")("privateStatsKillSwitchGetBlockedToken not implemented for WAM DB");return a.privateStatsKillSwitchGetBlockedToken()}function x(b){var a=q("privateStatsKillSwitchSet");if(!a.privateStatsKillSwitchSet)throw c("WAErr")("privateStatsKillSwitchSet not implemented for WAM DB");return a.privateStatsKillSwitchSet(b)}function y(a){return q("removeBufferByKey").removeBufferByKey(a)}function z(){return q("nukeMetrics").nukeMetrics()}g.startWamStorage=a;g.closeWamStorage=e;g.initializeWAMSink=f;g.getFinishedStreamBuffers=r;g.redeemPrivateStatsToken=u;g.savePrivateStatsToken=v;g.privateStatsKillSwitchGetBlockedToken=w;g.privateStatsKillSwitchSet=x;g.removeBufferByKey=y;g.nukeMetrics=z}),98);
__d("privateStatsToken",["Promise","WABinary","WACryptoDependencies","WACryptoPrimitives","WADeprecatedSendIq","WADeprecatedWapParser","WAErrors","WALogger","WAPromiseRetryLoop","WATimeUtils","WAWamPrivateStatsToken","WAWamStorage","WAWap"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["issuePrivateStatsToken: Disconnected"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["issuePrivateStatsToken: failed to unblind the signed token"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["issuePrivateStatsToken: failed ",""]);k=function(){return a};return a}var l=3,m=new(c("WADeprecatedWapParser"))("issuePrivateStatsToken",function(a){a=a.child("sign_credential");var b=a.child("signed_credential");b=b.contentBytes();a=a.child("acs_public_key");a=a.contentBytes();return{signedCredential:b,acsPublicKey:a}});function n(a){switch(a.errorCode){case 400:return"bad-request";case 500:return"internal-server-error";case 501:return"feature-not-implemented";case 503:return"service-unavailable";default:return"unknown"}}function o(a){var c=d("WATimeUtils").monotonicTime(),e={overallStartTime:c,retryStartTime:c,retryAttemptsLeft:l},f=new Uint8Array(32);d("WACryptoDependencies").getCrypto().getRandomValues(f);var g=new Uint8Array(32);d("WACryptoDependencies").getCrypto().getRandomValues(g);var o=d("WAWamPrivateStatsToken").blindToken(f,g);c=function(c){e.retryAttemptsLeft<l&&(e.retryStartTime=d("WATimeUtils").monotonicTime());var p=d("WAWap").wap("iq",{xmlns:"privatestats",id:d("WAWap").generateId(),type:"get",to:d("WAWap").S_WHATSAPP_NET},d("WAWap").wap("sign_credential",{version:"1"},d("WAWap").wap("blinded_credential",null,o))),q=a||d("WADeprecatedSendIq").deprecatedSendIqWithoutRetry;return q(p,m).then(function(a){if(!a.success){var b=n(a);d("WALogger").WARN(k(),b);b!=="internal-server-error"||e.retryAttemptsLeft<=0?c({result:null,metric:babelHelpers["extends"]({},e,{result:b})}):e.retryAttemptsLeft--;return}b=a.result;a=b.signedCredential;b=b.acsPublicKey;a=d("WAWamPrivateStatsToken").unblindToken(a,g,b);if(a==null){d("WALogger").WARN(j());c({result:null,metric:babelHelpers["extends"]({},e,{result:"decryption-error"})});return}b=d("WABinary").Binary.build(f,a);a=d("WACryptoPrimitives").hash(b.readByteArray());c({result:{token:f,sharedSecret:a},metric:babelHelpers["extends"]({},e,{result:"success"})})})["catch"](function(a){if(a instanceof d("WAErrors").Disconnected)d("WALogger").WARN(i()),e.retryAttemptsLeft<=0?c({result:null,metric:babelHelpers["extends"]({},e,{result:"disconnected"})}):e.retryAttemptsLeft--;else return(h||(h=b("Promise"))).reject(a)})};c=new(d("WAPromiseRetryLoop").PromiseRetryLoop)({name:"issuePrivateStatsToken",timer:{algo:{type:"exponential",first:250},max:1e3},code:c});c.start();return c.promise()}function a(a){return d("WAWamStorage").redeemPrivateStatsToken().then(function(b){return b?{result:b}:o(a).then(function(a){var b=babelHelpers["extends"]({},a);a=a.result;return a?d("WAWamStorage").savePrivateStatsToken(a).then(function(){return b}):b})})}g.issuePrivateStatsToken=o;g.getToken=a}),98);
__d("WAWebIssuePrivateStatsToken",["WADeprecatedSendIq","WALogger","WASemaphore","WATimeUtils","WAWebSignCredentialWamEvent","WAWebWamEnumApplicationState","WAWebWamEnumSignCredentialResult","asyncToGeneratorRuntime","privateStatsToken"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Couldn't get a private stats token"]);h=function(){return a};return a}var i=3;function j(a){switch(a){case"success":return d("WAWebWamEnumSignCredentialResult").SIGN_CREDENTIAL_RESULT.SUCCESS;case"bad-request":return d("WAWebWamEnumSignCredentialResult").SIGN_CREDENTIAL_RESULT.ERROR_BAD_REQUEST;case"internal-server-error":return d("WAWebWamEnumSignCredentialResult").SIGN_CREDENTIAL_RESULT.ERROR_SERVER;case"disconnected":return d("WAWebWamEnumSignCredentialResult").SIGN_CREDENTIAL_RESULT.ERROR_CLIENT_NETWORK;default:a;return d("WAWebWamEnumSignCredentialResult").SIGN_CREDENTIAL_RESULT.ERROR_OTHER}}function k(a){var b=a.result,c=a.overallStartTime,e=a.retryStartTime;a=a.retryAttemptsLeft;var f=j(b);new(d("WAWebSignCredentialWamEvent").SignCredentialWamEvent)({signCredentialResult:f,overallT:d("WATimeUtils").monotonicTimeSince(c),signCredentialT:d("WATimeUtils").monotonicTimeSince(e),retryCount:i-a,waConnectedToChatd:b!=="disconnected",applicationState:document.visibilityState==="visible"?d("WAWebWamEnumApplicationState").APPLICATION_STATE.FOREGROUND:d("WAWebWamEnumApplicationState").APPLICATION_STATE.BACKGROUND}).commit()}var l=new(d("WASemaphore").Semaphore)(1);function a(){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield l.acquire());try{var b=(yield d("privateStatsToken").getToken(d("WADeprecatedSendIq").deprecatedSendIqWithoutRetry)),c=b.result;b=b.metric;b!=null&&k(b);c||d("WALogger").WARN(h());return c}finally{a.release()}});return m.apply(this,arguments)}g.getToken=a}),98);
__d("WASmaxInStatsIQErrorBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","bad-request");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",400);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorBadRequestMixin=a}),98);
__d("WASmaxInStatsIQErrorFeatureNotImplementedMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","feature-not-implemented");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",501);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorFeatureNotImplementedMixin=a}),98);
__d("WASmaxInStatsIQErrorNotAcceptableMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"field");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"name");if(!b.success)return b;a=d("WASmaxParseUtils").attrString(a,"reason");return!a.success?a:d("WAResultOrError").makeResult({name:b.value,reason:a.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"field",h);if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","not-acceptable");if(!c.success)return c;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",406);return!a.success?a:d("WAResultOrError").makeResult({text:c.value,code:a.value,field:b.value})}g.parseIQErrorNotAcceptableField=h;g.parseIQErrorNotAcceptableMixin=a}),98);
__d("WASmaxInStatsIQErrorBadRequestOrNotAcceptableOrFeatureNotImplementedMixinGroup",["WAResultOrError","WASmaxInStatsIQErrorBadRequestMixin","WASmaxInStatsIQErrorFeatureNotImplementedMixin","WASmaxInStatsIQErrorNotAcceptableMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInStatsIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:b.value});var c=d("WASmaxInStatsIQErrorNotAcceptableMixin").parseIQErrorNotAcceptableMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IQErrorNotAcceptable",value:c.value});var e=d("WASmaxInStatsIQErrorFeatureNotImplementedMixin").parseIQErrorFeatureNotImplementedMixin(a);return e.success?d("WAResultOrError").makeResult({name:"IQErrorFeatureNotImplemented",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorBadRequest","IQErrorNotAcceptable","IQErrorFeatureNotImplemented"],[b,c,e])}g.parseIQErrorBadRequestOrNotAcceptableOrFeatureNotImplementedMixinGroup=a}),98);
__d("WASmaxInStatsIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","error");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQErrorResponseMixin=a}),98);
__d("WASmaxInStatsSendBufferResponseErrorNoRetry",["WAResultOrError","WASmaxInStatsIQErrorBadRequestOrNotAcceptableOrFeatureNotImplementedMixinGroup","WASmaxInStatsIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInStatsIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInStatsIQErrorBadRequestOrNotAcceptableOrFeatureNotImplementedMixinGroup").parseIQErrorBadRequestOrNotAcceptableOrFeatureNotImplementedMixinGroup(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorIQErrorBadRequestOrNotAcceptableOrFeatureNotImplementedMixinGroup:b.value}))}g.parseSendBufferResponseErrorNoRetry=a}),98);
__d("WASmaxInStatsIQErrorServiceUnavailableMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","service-unavailable");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",503);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorServiceUnavailableMixin=a}),98);
__d("WASmaxInStatsSendBufferResponseErrorRetry",["WAResultOrError","WASmaxInStatsIQErrorResponseMixin","WASmaxInStatsIQErrorServiceUnavailableMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;c=d("WASmaxInStatsIQErrorServiceUnavailableMixin").parseIQErrorServiceUnavailableMixin(c.value);if(!c.success)return c;a=d("WASmaxInStatsIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({errorIQErrorServiceUnavailableMixin:c.value},a.value))}g.parseSendBufferResponseErrorRetry=a}),98);
__d("WASmaxInStatsIQResultResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQResultResponseMixin=a}),98);
__d("WASmaxInStatsSendBufferResponseSuccess",["WASmaxInStatsIQResultResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInStatsIQResultResponseMixin").parseIQResultResponseMixin(a,b);return!c.success?c:c}g.parseSendBufferResponseSuccess=a}),98);
__d("WASmaxOutStatsBaseIQSetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("iq",{id:d("WAWap").generateId(),type:"set"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBaseIQSetRequestMixin=a}),98);
__d("WASmaxOutStatsSendBufferRequest",["WASmaxJsx","WASmaxOutStatsBaseIQSetRequestMixin","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=a.addT;a=a.addElementValue;b=d("WASmaxOutStatsBaseIQSetRequestMixin").mergeBaseIQSetRequestMixin(d("WASmaxJsx").smax("iq",{xmlns:"w:stats",to:d("WAWap").S_WHATSAPP_NET},d("WASmaxJsx").smax("add",{t:d("WAWap").INT(b)},a)));return b}g.makeSendBufferRequest=a}),98);
__d("WASmaxStatsSendBufferRPC",["WAComms","WASmaxInStatsSendBufferResponseErrorNoRetry","WASmaxInStatsSendBufferResponseErrorRetry","WASmaxInStatsSendBufferResponseSuccess","WASmaxOutStatsSendBufferRequest","WASmaxParsingFailure","WASmaxRpcUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:e=d("WASmaxOutStatsSendBufferRequest").makeSendBufferRequest(a);j.next=3;return b("regeneratorRuntime").awrap(d("WAComms").sendSmaxStanza(e,c));case 3:f=j.sent;g=d("WASmaxInStatsSendBufferResponseSuccess").parseSendBufferResponseSuccess(f,e);if(!g.success){j.next=7;break}return j.abrupt("return",{name:"SendBufferResponseSuccess",value:g.value});case 7:h=d("WASmaxInStatsSendBufferResponseErrorNoRetry").parseSendBufferResponseErrorNoRetry(f,e);if(!h.success){j.next=10;break}return j.abrupt("return",{name:"SendBufferResponseErrorNoRetry",value:h.value});case 10:i=d("WASmaxInStatsSendBufferResponseErrorRetry").parseSendBufferResponseErrorRetry(f,e);if(!i.success){j.next=13;break}return j.abrupt("return",{name:"SendBufferResponseErrorRetry",value:i.value});case 13:throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("SendBuffer",{Success:g,ErrorNoRetry:h,ErrorRetry:i}));case 14:case"end":return j.stop()}},null,this)}g.sendSendBufferRPC=a}),98);
__d("WAWebStatsUploadJob",["Promise","WALogger","WASmaxStatsSendBufferRPC","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["SendBufferResponseErrorRetry: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["SendBufferResponseErrorNoRetry: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["fieldStatsUpload:sendSendBufferRPC SendBufferResponseSuccess"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["fieldStatsUpload:sendSendBufferRPC end"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["fieldStatsUpload:sendSendBufferRPC start"]);m=function(){return a};return a}function a(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){d("WALogger").LOG(m());c=(yield d("WASmaxStatsSendBufferRPC").sendSendBufferRPC({addT:c,addElementValue:a}));d("WALogger").LOG(l());if(c.name==="SendBufferResponseSuccess"){d("WALogger").LOG(k());return(h||(h=b("Promise"))).resolve()}else c.name==="SendBufferResponseErrorNoRetry"?(a=c.value.errorIQErrorBadRequestOrNotAcceptableOrFeatureNotImplementedMixinGroup.value,d("WALogger").DEV(j(),a.code)):(c.name,a=c.value.errorIQErrorServiceUnavailableMixin,d("WALogger").DEV(i(),a.code));c=a;a=c.code;c=c.text;return{errorCode:parseInt(a,10),errorText:c}});return n.apply(this,arguments)}g["default"]=a}),98);
__d("WAWebGroupParticipantsJob",["WAJobOrchestratorTypes","WAWebGroupsParticipantsApi","WAWebOrchestratorNonPersistedJob"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("updateParticipants",function(a){return d("WAWebGroupsParticipantsApi").updateParticipants(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted(a)}function b(a,b,c,e){a={group:a,participants:b,isOffline:c,reason:e};return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("addParticipants",function(a){return d("WAWebGroupsParticipantsApi").addParticipants(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted(a)}function c(a,b,c,e,f,g,h){a={group:a,participants:b,timestamp:c,author:e,reason:f,groupMetadata:g,isOffline:h};return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("removeParticipants",function(a){return d("WAWebGroupsParticipantsApi").removeParticipants(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted(a)}function e(a,b,c,e){a={group:a,participants:b,groupMetadata:c,isOffline:e};return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("demoteParticipants",function(a){return d("WAWebGroupsParticipantsApi").demoteParticipants(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted(a)}function f(a,b,c,e){a={group:a,participants:b,groupMetadata:c,isOffline:e};return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("promoteParticipants",function(a){return d("WAWebGroupsParticipantsApi").promoteParticipants(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted(a)}function h(a,b,c){a={group:a,participants:b,isOffline:c};return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("promoteCommunityParticipants",function(a){return d("WAWebGroupsParticipantsApi").promoteCommmunityParticipants(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted(a)}function i(a,b,c){a={group:a,participants:b,isOffline:c};return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("demoteCommunityParticipants",function(a){return d("WAWebGroupsParticipantsApi").demoteCommmunityParticipants(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted(a)}g.updateParticipantsJob=a;g.addParticipantsJob=b;g.removeParticipantsJob=c;g.demoteParticipantsJob=e;g.promoteParticipantsJob=f;g.promoteCommunityParticipantsJob=h;g.demoteCommunityParticipantsJob=i}),98);
__d("WAWebApiUnjoinedSubgroupMetadataStore",["WAWebSchemaUnjoinedSubgroupMetadata","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){d("WAWebSchemaUnjoinedSubgroupMetadata").getUnjoinedSubgroupMetadataTable().remove(a.toString())}function h(a){var b={},c=a.defaultSubgroup,d=a.generalSubgroup,e=a.parentGroupId,f=babelHelpers.objectWithoutPropertiesLoose(a,["defaultSubgroup","generalSubgroup","parentGroupId"]);c!=null&&(b.defaultSubgroup=c);d!=null&&(b.generalSubgroup=d);e!=null&&(b.parentGroup=e.toString());return babelHelpers["extends"]({},f,b,{id:a.id.toString()})}function c(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.unjoinedSubgroups,c=a.parentGroupId;a=a.link;if(!a){yield d("WAWebSchemaUnjoinedSubgroupMetadata").getUnjoinedSubgroupMetadataTable().bulkRemove(b.map(function(a){return a.id.toString()}));return}a=[];var e=(yield d("WAWebSchemaUnjoinedSubgroupMetadata").getUnjoinedSubgroupMetadataTable().bulkGet(b.map(function(a){return a.id.toString()})));a=b.map(function(a,b){b=e[b];var d={subject:a.subject,subjectTime:a.subjectTime||0};if(b){var f=b.subjectTime||0;f>d.subjectTime&&(d={subject:b.subject,subjectTime:f})}return h(babelHelpers["extends"]({},a,d,{parentGroupId:c}))});yield d("WAWebSchemaUnjoinedSubgroupMetadata").getUnjoinedSubgroupMetadataTable().bulkCreateOrMerge(a)});return i.apply(this,arguments)}function e(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.unjoinedSubgroupIds;a=a.parentGroupId;a=(yield d("WAWebSchemaUnjoinedSubgroupMetadata").getUnjoinedSubgroupMetadataTable().equals(["parentGroup"],a.toString()));a=a.map(function(a){return a.id});var c=b.map(function(a){return a.toString()});b=a.filter(function(a){return!c.includes(a)});yield d("WAWebSchemaUnjoinedSubgroupMetadata").getUnjoinedSubgroupMetadataTable().bulkRemoveByIndex(["id"],b)});return j.apply(this,arguments)}g.removeUnjoinedSubgroupMetadataFromStorage=a;g.updateUnjoinedSubgroups=c;g.cleanUnjoinedSubgroups=e}),98);
__d("WAWebGroupUnjoinedSubgroupJob",["WAJobOrchestratorTypes","WAWebApiUnjoinedSubgroupMetadataStore","WAWebOrchestratorNonPersistedJob"],(function(a,b,c,d,e,f,g){function a(a,b,c){c===void 0&&(c=!0);return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("updateUnjoinedSubgroups",function(a){return d("WAWebApiUnjoinedSubgroupMetadataStore").updateUnjoinedSubgroups(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted({unjoinedSubgroups:a,parentGroupId:b,link:c})}function b(a,b){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("cleanUnjoinedSubgroups",function(a){return d("WAWebApiUnjoinedSubgroupMetadataStore").cleanUnjoinedSubgroups(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted({unjoinedSubgroupIds:a,parentGroupId:b})}g.updateUnjoinedSubgroupsJob=a;g.cleanUnjoinedSubgroupsJob=b}),98);
__d("WAWebFetchPrekeysJob",["WALogger","WAParsableXmlNode","WASmaxPreKeysFetchKeyBundlesRPC","WAWebBackendErrors","WAWebProcessKeyBundle","WAWebWidFactory","WAWebWidToJid","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["fetchPrekeys: successfully established "," E2E sessions out of "," requested"]);h=function(){return a};return a}function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b===void 0&&(b=!1);var e=(yield d("WASmaxPreKeysFetchKeyBundlesRPC").sendFetchKeyBundlesRPC({userArgs:a.map(function(a){return{userJid:d("WAWebWidToJid").widToDeviceJid(a),hasUserReasonIdentity:b}})}));if(e.name==="FetchKeyBundlesResponseServerError"){var f=e.value.errorServerErrors.value;throw new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(f.code),"fetchPrekeys: server error: "+f.code+" "+f.text)}else if(e.name==="FetchKeyBundlesResponseRequestError"){f=e.value.errorRequestErrorsFetch.value;throw new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(f.code),"fetchPrekeys: request error: "+f.code+" "+f.text)}f=e.value.listUser.map(function(a){var b=a.userFetchKeyBundlesSuccessOrFetchKeyBundlesErrorOrFetchKeyBundlesErrorFallbackMixinGroup;switch(b.name){case"FetchKeyBundlesUserSuccess":var e=b.value,f=e.preKeyMixin,g=e.elementValue,h=e.deviceIdentityMixin,i=e.skeyIdKeyIDMixin,j=e.skeyValueKeyDataMixin,k=e.skeySignatureElementValue;e=e.registrationElementValue;return{deviceIdentity:(h=h==null?void 0:h.deviceIdentityElementValue)!=null?h:null,identity:g,skey:{id:d("WAParsableXmlNode").convertBytesToUint(i.elementValue,3),pubkey:j.elementValue,signature:k},key:f?{id:d("WAParsableXmlNode").convertBytesToUint(f.keyIdKeyIDMixin.elementValue,3),pubkey:(h=f.keyValueKeyDataMixin)==null?void 0:h.elementValue}:null,regId:d("WAParsableXmlNode").convertBytesToUint(e,4),wid:d("WAWebWidFactory").createWid(a.jid)};case"FetchKeyBundlesUserErrorFallback":case"FetchKeyBundlesUserError":g=b.value;i=g.errorCode;j=g.errorText;return c("err")("fetchPrekeys: list item error: "+i+" "+j)}});if(f.length===0)throw c("err")("fetchPrekeys: empty key info");e=(yield d("WAWebProcessKeyBundle").processKeyBundles(f));f=e.depletedPrekeyCount;e=e.processedPrekeyCount;d("WALogger").LOG(h(),e,a.length);return{depletedPrekeyCount:f}});return i.apply(this,arguments)}g.fetchPrekeys=a}),98);
__d("WAWebManageE2ESessionsJob",["Promise","WALogger","WAResolvable","WAShiftTimer","WAWebEventsWaitForOfflineDeliveryEnd","WAWebFetchPrekeysJob","WAWebSignal","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["ensureE2ESessions: "," wids: "," existing sessions, "," requested, "," requests deduplicated"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["ensureE2ESessions: "," wids: deduped requests failed: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["ensureE2ESessions: "," wids: request failed: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["ensureE2ESessions: can only estabilish session with user wid"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["ensureE2ESessions: "," wids: ",""]);m=function(){return a};return a}var n=new Map(),o=new Map();function p(a,b){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){c===void 0&&(c=!1);yield d("WAWebEventsWaitForOfflineDeliveryEnd").waitForOfflineDeliveryEnd();d("WALogger").LOG(m(),a.length,a.map(function(a){return a.toString()}).join());var e=new(d("WAResolvable").Resolvable)(),f=[],g=[];a.forEach(function(a){if(!a.isUserNotPSA()){d("WALogger").LOG(l());return}var b=n.get(a.toString());b&&(b.cancel(),n["delete"](a.toString()));b=o.get(a.toString());b?f.push(b):(g.push(a),o.set(a.toString(),e.promise))});var p=0,q=0;try{if(g.length>0){var r=(yield d("WAWebSignal").Session.hasSignalSessions(g)),s=g.filter(function(a,b){return!r[b]});if(s.length>0){c=(yield d("WAWebFetchPrekeysJob").fetchPrekeys(s,c));q=(c=c.depletedPrekeyCount)!=null?c:0;p=s.length}}e.resolve()}catch(b){d("WALogger").WARN(k(),a.length,b);e.resolve(b);throw b}finally{g.forEach(function(a){return o["delete"](a.toString())})}try{c=(yield (h||(h=b("Promise"))).all(f)).find(Boolean);if(c)throw c}catch(b){d("WALogger").WARN(j(),a.length,b);throw b}d("WALogger").LOG(i(),a.length,g.length-p,p,f.length);return{missedPrekeyCount:p,depletedPrekeyCount:q}});return q.apply(this,arguments)}function a(a,b,c){c===void 0&&(c=!1);var e=new(d("WAShiftTimer").ShiftTimer)(function(){p(a,c)});a.forEach(function(a){n.set(String(a),e)});e.onOrAfter(1e3*b)}g.ensureE2ESessions=p;g.ensureE2ESessionsWithDelay=a}),98);
__d("WAWebSendDeliveryReceiptJob",["Promise","WADeprecatedSendIq","WAJids","WAWap","WAWebCommsWapMd","WAWebMessagingGatingUtils","WAWebOnlineDanglingReceipts","WAWebSchemaInactiveReceipt","WAWebSendReceiptJobCommon","WAWebUserPrefsMeUser","WAWebWidFactory","WAWebWidToJid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(){return d("WAWebSchemaInactiveReceipt").getInactiveReceiptTable().all().then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=new Map(),e=Date.now().toString();a.forEach(function(a){var b=a.msgId,e=a.chatId;a=a.participantId;e=d("WAWebWidFactory").createWid(e);a=a?d("WAWebWidFactory").createWid(a):null;a=a||e;var f=c.get(e);f||(f=new Map(),c.set(e,f));e=f.get(a);e||(e=[],f.set(a,e));e.push(b)});yield (h||(h=b("Promise"))).all(Array.from(c.keys()).map(function(a){var b=c.get(a);if(!b)return;return d("WAWebSendReceiptJobCommon").sendAggregateReceipts({to:a,type:d("WAWebSendReceiptJobCommon").RECEIPT_TYPE.DELIVERY,t:e,groupedReceipt:b})}));return d("WAWebSchemaInactiveReceipt").getInactiveReceiptTable().bulkRemove(a.map(function(a){return a.msgId}))});return function(b){return a.apply(this,arguments)}}())}function c(a,b,c,d,e,f){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f,g,i){g===void 0&&(g=!1);var k=d("WAWebUserPrefsMeUser").assertGetMe(),l=c.isUser()&&d("WAWebWidFactory").toUserWid(k).equals(d("WAWebWidFactory").toUserWid(c))||f!=null&&d("WAWebWidFactory").toUserWid(k).equals(d("WAWebWidFactory").toUserWid(f));k=i.hasInactiveMsg===!0&&!l;var m=!k;i=(h||(h=b("Promise"))).resolve();if(!m&&!d("WAWebMessagingGatingUtils").isInactiveReceiptsV2Enabled()){k={msgId:a,chatId:c.toString(),participantId:f?f.toString():null};i=d("WAWebSchemaInactiveReceipt").getInactiveReceiptTable().createOrReplace(k)}return i.then(function(){void j(a,c,e,f,m,l,g);if(m)return d("WAWebSchemaInactiveReceipt").getInactiveReceiptTable().remove(a)})});return i.apply(this,arguments)}function j(a,b,c,d,e,f,g){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f,g,h){var i=d("WAWap").DROP_ATTR;h?i=d("WAWap").CUSTOM_STRING(d("WAWebSendReceiptJobCommon").RECEIPT_TYPE.PEER_MSG):g?i=d("WAWap").CUSTOM_STRING(d("WAWebSendReceiptJobCommon").RECEIPT_TYPE.SENDER):f||(i=d("WAWap").CUSTOM_STRING(d("WAWebSendReceiptJobCommon").RECEIPT_TYPE.INACTIVE));f=(yield d("WAWebSendReceiptJobCommon").shouldRequestTcToken(b,i,d("WAWap").DROP_ATTR));var j=d("WAJids").extractJidFromJidWithType(d("WAWebWidToJid").widToJidWithType(b));j=d("WAWap").wap("receipt",{id:d("WAWap").CUSTOM_STRING(a),to:d("WAWap").JID(j),participant:(b.isGroup()||b.isBroadcast())&&e?d("WAWebCommsWapMd").DEVICE_JID(e):d("WAWap").DROP_ATTR,recipient:!h&&g&&c?d("WAWebCommsWapMd").USER_JID(c):d("WAWap").DROP_ATTR,type:i,privacy_token:f?d("WAWap").CUSTOM_STRING("false"):d("WAWap").DROP_ATTR});d("WAWebOnlineDanglingReceipts").addOnlineDanglingReceipts(b,e||b,a);d("WADeprecatedSendIq").deprecatedCastStanza(j)});return k.apply(this,arguments)}g.sendDeliveryReceiptsAfterPresence=a;g.sendDeliveryReceiptsAfterDecryption=c}),98);
__d("WAWebWamEnumPsBufferUploadResult",[],(function(a,b,c,d,e,f){a=Object.freeze({SUCCESS:1,ERROR_PARSING:2,ERROR_DECODING:3,ERROR_CREDENTIAL:4,ERROR_OTHER:5,ERROR_CLIENT_NETWORK:6,ERROR_WAIT_FOR_TOKEN:7,ERROR_SERVER_OTHER:8,SKIPPED_NO_NETWORK:9,SKIPPED_NO_DATA:10,ERROR_ACCESS_TOKEN:11});f.PS_BUFFER_UPLOAD_RESULT=a}),66);
__d("WAWebWamEnumPsTokenNotReadyReason",[],(function(a,b,c,d,e,f){a=Object.freeze({NO_REASON:0,REASON_UNKNOWN:1,REASON_WAIT_FOR_FIRST_TOKEN:2,REASON_INVALID_SHARED_KEY:3,REASON_INVALID_FACTOR:4,REASON_GEN_FACTOR_FAILURE:5,REASON_COMPUTE_HMAC_FAILURE:6,REASON_BLIND_FAILURE:7,REASON_UNBLIND_FAILURE:8,REASON_LAST_SIGNREQ_NETWORK_FAILURE:9,REASON_LAST_SIGNREQ_SERVER_ERROR:10,REASON_LAST_SIGNREQ_BAD_REQUEST:11,REASON_LAST_SIGNREQ_OTHER_ERROR:12,REASON_WAIT_FOR_GEN_TOKEN:13,REASON_GEN_SHAREDKEY_FAILURE:14,REASON_WAIT_FOR_GEN_FIRST_TOKEN:15});f.PS_TOKEN_NOT_READY_REASON=a}),66);
__d("WAWebWamEnumPsUploadReason",[],(function(a,b,c,d,e,f){a=Object.freeze({REASON_PS_PINGER:0,REASON_PS_OFFCYCLE:1});f.PS_UPLOAD_REASON=a}),66);
__d("WAWebPsBufferUploadWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumApplicationState","WAWebWamEnumPsBufferUploadResult","WAWebWamEnumPsTokenNotReadyReason","WAWebWamEnumPsUploadReason"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({PsBufferUpload:[2244,{applicationState:[6,d("WAWebWamEnumApplicationState").APPLICATION_STATE],isFromWamsys:[12,a.TYPES.BOOLEAN],isUserSampled:[14,a.TYPES.BOOLEAN],psBufferSequenceNumber:[13,a.TYPES.INTEGER],psBufferUploadHttpResponseCode:[3,a.TYPES.INTEGER],psBufferUploadResult:[1,d("WAWebWamEnumPsBufferUploadResult").PS_BUFFER_UPLOAD_RESULT],psBufferUploadT:[2,a.TYPES.TIMER],psDitheredT:[11,a.TYPES.INTEGER],psForceUpload:[10,a.TYPES.BOOLEAN],psTokenNotReadyReason:[4,d("WAWebWamEnumPsTokenNotReadyReason").PS_TOKEN_NOT_READY_REASON],psUploadReason:[9,d("WAWebWamEnumPsUploadReason").PS_UPLOAD_REASON],waConnectedToChatd:[5,a.TYPES.BOOLEAN]},[1,1,1],"regular"]},{PsBufferUpload:[]});g.PsBufferUploadWamEvent=b}),98);
__d("privateStatsUpload",["Promise","WABase64","WACryptoHmac","WALogger","WAPromiseRetryLoop","WATimeUtils","WAWamStorage","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Ran out of available retries for a private stats buffer submission"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unsupported code value in the error response 400 from PrivateStats upload request: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unsupported subcode value in the error response 400 from PrivateStats upload request: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Incorrect code or subcode in the error response 400 from PrivateStats upload request"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Incorrect or missing error entry in the error response 400 from PrivateStats upload request"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unable to parse error response 400 from PrivateStats upload request or parsed response is not an object"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unsupported response status code from PrivateStats upload request: ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["Try to submit metrics without being connected to the VPN. The PrivateStats endpoint seems to reject VPN originating connections at the CORS check level"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["Upload of a private stats buffer failed: ",""]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["Couldn't get token to submit a private stats buffer"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["Removing private stats buffer without submitting it (kill switch)"]);s=function(){return a};return a}var t="https://dit.whatsapp.net/deidentified_telemetry",u="245118376424571|3e7d275052f1522bf3200afcf53841a7",v=0,w="WAMEventBuffer.dat",x=3,y=9,z=111e3,A=3067002,B=3067003,C=3067004;function D(a){return{result:a.result,httpResponseCode:a.httpResponseCode,uploadTime:d("WATimeUtils").monotonicTimeSince(a.uploadStartTime)}}function E(a,c,e,f){var g,i,j,k,l,m,n,x,y,z,A,B,C,D,E,G;return b("regeneratorRuntime").async(function(H){while(1)switch(H.prev=H.next){case 0:H.next=2;return b("regeneratorRuntime").awrap(d("WAWamStorage").privateStatsKillSwitchGetBlockedToken());case 2:H.t0=H.sent;H.t1=u;if(!(H.t0===H.t1)){H.next=7;break}d("WALogger").LOG(s());return H.abrupt("return",d("WAWamStorage").removeBufferByKey(e.key).then(function(){a()}));case 7:g=d("WATimeUtils").monotonicTime();H.next=10;return b("regeneratorRuntime").awrap(f());case 10:i=H.sent;if(!(i==null)){H.next=15;break}d("WALogger").ERROR(r());a();return H.abrupt("return");case 15:j=new FormData();j.append("access_token",u);H.next=19;return b("regeneratorRuntime").awrap(d("WACryptoHmac").hmacSha256(i.sharedSecret,e.content));case 19:k=H.sent;l=d("WABase64").encodeB64UrlSafe(i.token,!0);m=d("WABase64").encodeB64UrlSafe(k,!0);n=l+"+"+m;j.append("credential",n);j.append("message",new Blob([e.content],{type:"application/octet-stream"}),w);j.append("meta_data",JSON.stringify({t:d("WATimeUtils").unixTime(),p:v}));x={method:"POST",body:j,"Content-Type":"multipart/form-data"};H.prev=27;H.next=30;return b("regeneratorRuntime").awrap(fetch(t,x));case 30:y=H.sent;H.next=39;break;case 33:H.prev=33;H.t2=H["catch"](27);d("WALogger").WARN(q(),H.t2);d("WALogger").DEV(p());c({uploadStartTime:g,result:"error-other"});return H.abrupt("return");case 39:z=y.status;A=function(b){a({uploadStartTime:g,httpResponseCode:z,result:b})};B=function(a){c({uploadStartTime:g,httpResponseCode:z,result:a})};H.t3=z;H.next=H.t3===200?45:H.t3===429?46:H.t3===401?48:H.t3===400?49:H.t3===500?57:59;break;case 45:return H.abrupt("return",d("WAWamStorage").removeBufferByKey(e.key).then(function(){A("success")}));case 46:A("error-server-other");return H.abrupt("return");case 48:return H.abrupt("return",(h||(h=b("Promise"))).all([d("WAWamStorage").privateStatsKillSwitchSet(u),d("WAWamStorage").removeBufferByKey(e.key)]).then(function(){A("error-access-token")}));case 49:H.next=51;return b("regeneratorRuntime").awrap(F(y));case 51:C=H.sent;D=C.result;E=C.shouldRetry;G={uploadStartTime:g,httpResponseCode:z,result:D};E==="retry"?c(G):a(G);return H.abrupt("return");case 57:B("error-server-other");return H.abrupt("return");case 59:d("WALogger").WARN(o(),z);B("error-other");return H.abrupt("return");case 62:case"end":return H.stop()}},null,this,[[27,33]])}function F(a){var c,e,f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:h.next=2;return b("regeneratorRuntime").awrap(a.json()["catch"](function(){}));case 2:c=h.sent;if(!(typeof c!=="object")){h.next=6;break}d("WALogger").WARN(n());return h.abrupt("return",{result:"error-other",shouldRetry:"retry"});case 6:e=c.error;if(!(typeof e!=="object")){h.next=10;break}d("WALogger").WARN(m());return h.abrupt("return",{result:"error-other",shouldRetry:"retry"});case 10:f=e.code,g=e.error_subcode;if(!(typeof f!=="number"||typeof g!=="number")){h.next=14;break}d("WALogger").WARN(l());return h.abrupt("return",{result:"error-other",shouldRetry:"retry"});case 14:h.t0=f;h.next=h.t0===y?17:h.t0===z?18:26;break;case 17:return h.abrupt("return",{result:"error-server-other",shouldRetry:"no-retry"});case 18:h.t1=g;h.next=h.t1===A?21:h.t1===B?22:h.t1===C?23:24;break;case 21:return h.abrupt("return",{result:"error-parsing",shouldRetry:"retry"});case 22:return h.abrupt("return",{result:"error-decoding",shouldRetry:"retry"});case 23:return h.abrupt("return",{result:"error-credential",shouldRetry:"retry"});case 24:d("WALogger").WARN(k(),g);return h.abrupt("return",{result:"error-other",shouldRetry:"retry"});case 26:d("WALogger").WARN(j(),f);return h.abrupt("return",{result:"error-other",shouldRetry:"retry"});case 28:case"end":return h.stop()}},null,this)}function G(a,c){a=a.map(function(a){var b=x,e=[],f=new(d("WAPromiseRetryLoop").PromiseRetryLoop)({name:"uploadPrivateStatsBuffer",timer:{algo:{type:"exponential",first:250},max:1e3},code:function(f){return E(f,function(a){a=D(a);e.push(a);b<=0?(d("WALogger").DEV(i()),f()):b--},a,c)}});f.start();return f.promise().then(function(b){if(b!=null){var c=D(b);e.push(c)}return{uploadedBufferKey:(b==null?void 0:b.result)==="success"?a.key:null,metrics:e}})});return(h||(h=b("Promise"))).all(a).then(function(a){var b=a.reduce(function(a,b){a.push.apply(a,b.metrics);return a},[]);a=a.reduce(function(a,b){b.uploadedBufferKey!=null&&a.push(b.uploadedBufferKey);return a},[]);return{uploadedBufferKeys:a,metrics:b}})}function a(a){return d("WAWamStorage").getFinishedStreamBuffers("private").then(function(b){return G(b,a)})}g.upload_UNSAFE_INTERNAL_DO_NOT_USE=G;g.uploadFinishedPrivateStatsBuffers=a}),98);
__d("WAWebUploadPrivateStatsBackend",["WABackoffUtils","WABase64","WALogger","WAPromiseDelays","WAPromiseLoop","WAWebIssuePrivateStatsToken","WAWebNetworkStatus","WAWebPsBufferUploadWamEvent","WAWebWamEnumApplicationState","WAWebWamEnumPsBufferUploadResult","asyncToGeneratorRuntime","privateStatsUpload"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam:sendLogs retry on error: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam:sendLogs failure error: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam:sendLogs success"]);j=function(){return a};return a}function a(a,c){var e=new Uint8Array(d("WABase64").decodeB64(a));return m(c,function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("privateStatsUpload").upload_UNSAFE_INTERNAL_DO_NOT_USE([{key:c,content:e}],d("WAWebIssuePrivateStatsToken").getToken)),f=b.uploadedBufferKeys;b=b.metrics;b.map(l);f.length===0&&a(c);d("WALogger").DEV(j());a(void 0)});return function(b){return a.apply(this,arguments)}}())}function k(a){switch(a){case"success":return d("WAWebWamEnumPsBufferUploadResult").PS_BUFFER_UPLOAD_RESULT.SUCCESS;case"error-server-other":return d("WAWebWamEnumPsBufferUploadResult").PS_BUFFER_UPLOAD_RESULT.ERROR_SERVER_OTHER;case"error-parsing":return d("WAWebWamEnumPsBufferUploadResult").PS_BUFFER_UPLOAD_RESULT.ERROR_PARSING;case"error-decoding":return d("WAWebWamEnumPsBufferUploadResult").PS_BUFFER_UPLOAD_RESULT.ERROR_DECODING;case"error-credential":return d("WAWebWamEnumPsBufferUploadResult").PS_BUFFER_UPLOAD_RESULT.ERROR_CREDENTIAL;case"error-other":return d("WAWebWamEnumPsBufferUploadResult").PS_BUFFER_UPLOAD_RESULT.ERROR_OTHER;default:a;return d("WAWebWamEnumPsBufferUploadResult").PS_BUFFER_UPLOAD_RESULT.ERROR_ACCESS_TOKEN}}function l(a){var b=a.result,c=a.uploadTime;a=a.httpResponseCode;b=k(b);new(d("WAWebPsBufferUploadWamEvent").PsBufferUploadWamEvent)({psBufferUploadResult:b,psBufferUploadT:c,psBufferUploadHttpResponseCode:a,applicationState:document.visibilityState==="visible"?d("WAWebWamEnumApplicationState").APPLICATION_STATE.FOREGROUND:d("WAWebWamEnumApplicationState").APPLICATION_STATE.BACKGROUND}).commit()}function m(a,e){return d("WAPromiseLoop").promiseLoop(function(){var f=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,f,g){f=d("WAPromiseDelays").delayMs(d("WABackoffUtils").expBackoff(g,12e4,1e3,.1));try{yield c("WAWebNetworkStatus").waitIfOffline({signal:new AbortController().signal});return yield e(b)}catch(c){if(g>1){d("WALogger").WARN(i(),String(c)).devConsole(c);return b(a)}d("WALogger").DEV(h(),String(c));return f}});return function(a,b,c){return f.apply(this,arguments)}}())}g["default"]=a}),98);
__d("WAWebUploadStatsBackend",["WABackoffUtils","WABase64","WALogger","WAPromiseDelays","WAPromiseLoop","WATimeUtils","WAWebBackendErrors","WAWebNetworkStatus","WAWebStatsUploadJob","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam:sendLogs retry on error: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam:sendLogs failure error: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam:sendLogs success"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam:sendLogs b64len:",""]);k=function(){return a};return a}function a(a,e){d("WALogger").DEV(k(),a.length);var f=new Uint8Array(d("WABase64").decodeB64(a)),g=d("WATimeUtils").unixTime();return l(e,function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield c("WAWebStatsUploadJob")(f,g));if(b==null?void 0:b.errorCode)if(b.errorCode>=500)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(b.errorCode,b.errorText);else a(e);d("WALogger").DEV(j());a(void 0)});return function(b){return a.apply(this,arguments)}}())}function l(a,e){return d("WAPromiseLoop").promiseLoop(function(){var f=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,f,g){f=d("WAPromiseDelays").delayMs(d("WABackoffUtils").expBackoff(g,12e4,1e3,.1));try{yield c("WAWebNetworkStatus").waitIfOffline({signal:new AbortController().signal});return yield e(b)}catch(c){if(g>1){d("WALogger").WARN(i(),String(c)).devConsole(c);return b(a)}d("WALogger").DEV(h(),String(c));return f}});return function(a,b,c){return f.apply(this,arguments)}}())}g["default"]=a}),98);
__d("WAWebModelStorage",["WAWebModelStorageInitialize","WAWebUserPrefsIndexedDBStorage","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebModelStorageInitialize").initializeWithoutGKs(a),yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.init()});return h.apply(this,arguments)}Object.keys(d("WAWebModelStorageInitialize")).forEach(function(a){if(a==="default"||a==="__esModule")return;g[a]=d("WAWebModelStorageInitialize")[a]});g.initialize=a}),98);
__d("WAWebABPropsGlobals",["WAWebWamGlobals"],(function(a,b,c,d,e,f,g){c=new Set();var h=new Set();function a(){d("WAWebWamGlobals").Global.set({expoKey:Array.from(h).join(",")})}function b(a){d("WAWebWamGlobals").Global.set({abKey2:a})}g.accessedConfigs=c;g.exposureKeys=h;g.updateGlobalExpoKey=a;g.updateGlobalABKey=b}),98);
__d("WAWebApiAbPropConfig",["Promise","WALogger","WAWebABPropsConfigs","WAWebABPropsGlobals","WAWebModelStorageInitialize","WAWebModelStorageUtils","WAWebSchemaAbPropConfig","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["invalid ABProps config name"]);i=function(){return a};return a}function a(){return d("WAWebModelStorageInitialize").initializeWithoutGKs().then(function(){return d("WAWebSchemaAbPropConfig").getAbpropConfigsTable().all().then(function(a){return a})})}function j(a,b,c){if(a==null||b==null)return c;else if(b==="bool")return a==="1"||a==="True"||a==="true";else if(b==="int")return parseInt(a,10);else if(b==="float")return parseFloat(a);return a}function e(a){var e=d("WAWebABPropsConfigs").ABPropConfigs[a];if(e==null){d("WALogger").ERROR(i()).verbose().sendLogs("invalid ABProps config name: "+a);return(h||(h=b("Promise"))).reject(c("err")("invalid ABProps config name"))}var f=e[0],g=e[1];a=e[2];e=e[3];var k=a;return d("WAWebModelStorageInitialize").initializeWithoutGKs().then(function(){return d("WAWebSchemaAbPropConfig").getAbpropConfigsTable().get(String(f)).then(function(a){a=a?j(a.configValue,g,k):k;return a})})}function f(a){return d("WAWebModelStorageUtils").getStorage().lock(["abpropConfigs"],function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var c=(yield b.all()),e=new Map();c.forEach(function(a){(a.configExpoKey!=null||a.overriddenConfigValue!=null)&&e.set(a.configCode,{configCode:a.configCode,configValue:a.configValue,configExpoKey:a.configExpoKey,hasAccessed:a.hasAccessed,overriddenConfigValue:a.overriddenConfigValue})});c=!1;var f=[];a.forEach(function(a,b){var g=!1,h=e.get(String(b));if(h){var i=h.configExpoKey;i!=null&&a.configExpoKey!==i?(d("WAWebABPropsGlobals").exposureKeys["delete"](i),c=!0,d("WAWebABPropsGlobals").accessedConfigs["delete"](b)):i!=null&&(g=h.hasAccessed)}f.push({configCode:String(b),configValue:a.configValue,configExpoKey:a.configExpoKey,hasAccessed:g,overriddenConfigValue:h==null?void 0:h.overriddenConfigValue})});c&&d("WAWebABPropsGlobals").updateGlobalExpoKey();yield b.clear();yield b.bulkCreate(f)});return function(a){return c.apply(this,arguments)}}())}function k(a){return d("WAWebModelStorageUtils").getStorage().lock(["abpropConfigs"],function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var c=(yield b.get(String(a)));if(c==null||(c==null?void 0:c.hasAccessed)===!0)return;yield b.merge(String(a),{hasAccessed:!0})});return function(a){return c.apply(this,arguments)}}())}g.getABPropConfigs=a;g.parseConfigValue=j;g.getConfigValue=e;g.updateABPropConfigs=f;g.setConfigAccessed=k}),98);
__d("WAWebApiPeerMessageStore",["WAWebMsgKey","WAWebSchemaPeerMessage","WAWebUserPrefsMeUser"],(function(a,b,c,d,e,f,g){function a(a){a=a.map(function(a){return babelHelpers["extends"]({},a,{id:String(a.id),to:String(a.to),subtype:String(a.subtype)})});d("WAWebSchemaPeerMessage").getPeerMessageTable().bulkCreate(a)}function b(a){var b=d("WAWebSchemaPeerMessage").getPeerMessageTable();a=new(c("WAWebMsgKey"))({fromMe:!0,remote:d("WAWebUserPrefsMeUser").getMeUser(),id:a});return b.remove(a.toString())}g.storePeerMessages=a;g.deletePeerMessage=b}),98);
__d("WAWebSchemaReadReceipt",["WAWebOffdStorageUtils","WAWebStorageMutationBuilder"],(function(a,b,c,d,e,f,g){c=d("WAWebStorageMutationBuilder").columnBuilder();var h=c.addColumn,i=c.addUserDefinedPrimaryKey;function a(){d("WAWebOffdStorageUtils").getStorage().add("read-receipt").version(d("WAWebOffdStorageUtils").getStorage().versions.version(0),[i("id"),h("externalIds")])["delete"](d("WAWebOffdStorageUtils").getStorage().versions.version(3)).view(function(a){return a})}function b(){return d("WAWebOffdStorageUtils").getStorage().table("read-receipt")}g.addTable=a;g.getTable=b}),98);
__d("WAWebOffdStorage",["WALogger","WAWeb-dexie","WAWebDbRolloutUtil","WAWebDexieCastTypes","WAWebOffdStorageUtils","WAWebSchemaDanglingReceipt","WAWebSchemaPeerReadReceipt","WAWebSchemaPendingDeviceSync","WAWebSchemaReadReceipt","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]);h=function(){return a};return a}f=4;var i;function a(){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){i==null&&(yield d("WAWebDbRolloutUtil").loadSchemaVersions(),d("WAWebOffdStorageUtils").createStorage(),d("WAWebSchemaReadReceipt").addTable(),d("WAWebSchemaDanglingReceipt").addTable(),d("WAWebSchemaPeerReadReceipt").addTable(),d("WAWebSchemaPendingDeviceSync").addTable(),i=d("WAWebOffdStorageUtils").getStorage().initialize()["catch"](function(a){d("WALogger").ERROR(h()).verbose().devConsole(a).tags("sad").sendLogs("Failed to initialize offd storage");throw a}));return i});return j.apply(this,arguments)}function e(){return d("WAWebOffdStorageUtils").destroyStorage()["catch"](function(){return d("WAWebDexieCastTypes").dexieCastToPromise(new(c("WAWeb-dexie"))(d("WAWebOffdStorageUtils").DATABASE_NAME)["delete"]())})["finally"](function(){i=null})}g.versionToRollout=f;g.initialize=a;g.destroy=e}),98);
__d("WAWebDexieBootstrap",["WAWeb-dexie"],(function(a,b,c,d,e,f,g){"use strict";function a(){c("WAWeb-dexie").Promise.PSD.onunhandled=function(){},c("WAWeb-dexie").Promise.PSD.txRelaxedDurabilityEnabled=!0}g.patchDexie=a}),98);
__d("WAWebSchemaLocalStorage",["WAWebStorageMutationBuilder","WAWebWorkerStorageUtils","WAWebWorkerStorageVersions"],(function(a,b,c,d,e,f,g){c=d("WAWebStorageMutationBuilder").columnBuilder();var h=c.addColumn,i=c.addUserDefinedPrimaryKey;function a(){d("WAWebWorkerStorageUtils").getStorage().add("local_storage").version(d("WAWebWorkerStorageVersions").localStorageCreateTable(),[i("key"),h("value")]).view(function(a){return{key:a.key,value:a.value}})}function b(){return d("WAWebWorkerStorageUtils").getStorage().table("local_storage")}g.addTable=a;g.getTable=b}),98);
__d("WAWebWorkerStorage",["WALogger","WAWeb-dexie","WAWebDbRolloutUtil","WAWebDexieBootstrap","WAWebDexieCastTypes","WAWebSchemaDeferredMessagesStorage","WAWebSchemaLocalStorage","WAWebWorkerStorageUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]);h=function(){return a};return a}var i;function a(){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WAWebDexieBootstrap").patchDexie();i==null&&(yield d("WAWebDbRolloutUtil").loadSchemaVersions(),d("WAWebWorkerStorageUtils").createStorage(),d("WAWebSchemaLocalStorage").addTable(),d("WAWebSchemaDeferredMessagesStorage").addTable(),i=d("WAWebWorkerStorageUtils").getStorage().initialize()["catch"](function(a){d("WALogger").ERROR(h()).verbose().devConsole(a).tags("sad").sendLogs("Failed to initialize worker storage");throw a}));return i});return j.apply(this,arguments)}function e(){return d("WAWebWorkerStorageUtils").destroyStorage()["catch"](function(){return d("WAWebDexieCastTypes").dexieCastToPromise(new(c("WAWeb-dexie"))(d("WAWebWorkerStorageUtils").DATABASE_NAME)["delete"]())})["finally"](function(){i=null})}g.getLocalStorageTable=d("WAWebSchemaLocalStorage").getTable;g.getDeferredMessagesTable=d("WAWebSchemaDeferredMessagesStorage").getTable;g.initialize=a;g.destroy=e}),98);
__d("WAWebApiLocalStorage",["WAWebSchemaLocalStorage","WAWebWorkerStorageUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebSchemaLocalStorage").getTable().get(a).then(function(a){return a==null?void 0:a.value})}function c(a){var c=a.map(function(a){return{key:a.key,value:a.value}});return d("WAWebWorkerStorageUtils").getStorage().lock(["local_storage"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];yield a.clear();yield a.bulkCreateOrReplace(c)});return function(b){return a.apply(this,arguments)}}())}function e(){return d("WAWebSchemaLocalStorage").getTable().clear()}g.getLocalStorageValue=a;g.updateLocalStorage=c;g.clearLocalStorage=e}),98);
__d("WAWebUserPrefsAppStateSync",["WAWebUserPrefsIndexedDBStorage","WAWebUserPrefsKeys","WAWebUserPrefsStore","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.CRITICAL_DATA_SYNCED,!0);return c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").MD_KEYS.CRITICAL_DATA_SYNCED,!0)});return h.apply(this,arguments)}function e(){var a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.CRITICAL_DATA_SYNCED);return a===!0}function f(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.LAST_PERIODIC_APP_STATE_SYNC_TS,a);return c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").MD_KEYS.LAST_PERIODIC_APP_STATE_SYNC_TS,a)});return i.apply(this,arguments)}function j(){var a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.RECENT_MAILBOX_AGE_DAYS);return a}function k(){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.SHOULD_CHECK_CONTACT_SYNC_STATUS,!0);return c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").MD_KEYS.SHOULD_CHECK_CONTACT_SYNC_STATUS,!0)});return l.apply(this,arguments)}function m(){var a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.MD_SYNC_ACTIONS_ACTION_SANITIZED);return a===!0}function n(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.MD_SYNC_ACTIONS_ACTION_SANITIZED,a),c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").MD_KEYS.MD_SYNC_ACTIONS_ACTION_SANITIZED,a)});return o.apply(this,arguments)}function p(){return c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").MD_KEYS.SYNCD_PRIMARY_ALLOWS_ALL_MUTATIONS,!0)}function q(){return!!c("WAWebUserPrefsStore").get(d("WAWebUserPrefsKeys").MD_KEYS.SYNCD_PRIMARY_ALLOWS_ALL_MUTATIONS)}function r(){return d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.NON_CRITICAL_DATA_SYNC_STATUS)}function s(a){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;b=(b=(yield r()))!=null?b:{};yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.NON_CRITICAL_DATA_SYNC_STATUS,babelHelpers["extends"]({},b,a))});return t.apply(this,arguments)}g.setAllCriticalDataSynced=a;g.getAllCriticalDataSynced=e;g.setLastPeriodicAppStateSyncTs=f;g.getLastPeriodicAppStateSyncTs=j;g.setShouldCheckContactSyncStatus=k;g.getMdSyncActionsActionSanitized=m;g.setMdSyncActionsActionSanitized=n;g.setPrimaryAllowsAllMutations=p;g.getPrimaryAllowsAllMutations=q;g.getNonCriticalDataSyncStatus=r;g.setNonCriticalDataSyncStatus=s}),98);
__d("WAWebSyncd",["Promise","WALogger","WASyncd","WASyncdConst","WASyncdDisabled","WAWebCmd","WAWebEventsWaitForOfflineDeliveryEnd","WAWebModelStorageUtils","WAWebSchemaSyncActions","WAWebSyncdDb","WAWebUserPrefsAppStateSync","asyncToGeneratorRuntime","lodash"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: invalid action ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["syncd: sanitizing null 'action' property in sync-actions table"]);j=function(){return a};return a}var k=["pending-mutations"];function a(){if(d("WASyncdDisabled").isSyncdDisabled())return(h||(h=b("Promise"))).resolve();l();d("WAWebEventsWaitForOfflineDeliveryEnd").waitForOfflineDeliveryEnd().then(function(){d("WASyncd").processOnAppResume()});m();return d("WASyncd").initializeStateMachine()}function l(){var a=1e3*60;a=c("lodash").debounce(d("WASyncd").reportWam,a,{maxWait:a*3});d("WAWebCmd").Cmd.on(d("WAWebCmd").APP_STATE_SYNC_COMPLETED,a)}function m(){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebUserPrefsAppStateSync").getMdSyncActionsActionSanitized());if(!a){d("WALogger").LOG(j());a=(yield d("WAWebSchemaSyncActions").getSyncActionsTable().all());a=a.filter(function(a){return a.action==null});a=a.map(function(a){var b=JSON.parse(a.index)[0],c=d("WASyncdConst").Actions.cast(b);if(!c){d("WALogger").LOG(i(),b);return babelHelpers["extends"]({},a)}return babelHelpers["extends"]({},a,{action:b})});yield d("WAWebSyncdDb").updateSyncActionRows(a);yield d("WAWebUserPrefsAppStateSync").setMdSyncActionsActionSanitized(!0)}});return n.apply(this,arguments)}function e(a,c,e){a=d("WAWebModelStorageUtils").getStorage().lock([].concat(a,k),function(a){return(h||(h=b("Promise"))).all([d("WAWebSyncdDb").appendPendingMutationsRows(c),e(a)])}).then(function(){var a=c.map(function(a){return a.collection});void d("WASyncd").markCollectionsForSync(a)});return(h||(h=b("Promise"))).resolve(a)}g.initialize=a;g.sanitizeActionInSyncActionsRow=m;g.lockForSync=e}),98);
__d("WAWebABPropsCache",["WALogger","WAWebABProps","WAWebABPropsConfigs","WAWebABPropsGlobals","WAWebApiAbPropConfig","WAWebRuntimeEnvironmentUtils","cr:4941","gkx"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[ABProps] configs need to be initialized before its first access, config name: ",""]);h=function(){return a};return a}var i=new Map(),j=!1,k;function a(a){k==null&&(k={},Object.keys(d("WAWebABPropsConfigs").ABPropConfigs).forEach(function(a){var b=d("WAWebABPropsConfigs").ABPropConfigs[a];b=b[0];k[b]=a}),Object.freeze(k));return k[a]}function e(){d("WAWebABProps").setGetABPropConfigValueImpl(l)}function l(a){var e=d("WAWebABPropsConfigs").ABPropConfigs[a],f=e[0],g=e[1],i=e[2];e=e[3];e=i;if(!c("gkx")("26258")&&!d("WAWebRuntimeEnvironmentUtils").isWorker()&&b("cr:4941")){i=new(b("cr:4941"))(window.location.search);i=i.get(a);if(i!=null&&i!=="")return d("WAWebApiAbPropConfig").parseConfigValue(i,g,e)}if(!j){d("WAWebABProps").usedBeforeInitializationConfigs.includes(a)||d("WALogger").WARN(h(),a);return e}return m(f)}function m(a){if(i.get(a)&&!d("WAWebABPropsGlobals").accessedConfigs.has(a)){var b;b=(b=i.get(a))==null?void 0:b.configExpoKey;b!=null&&!d("WAWebABPropsGlobals").exposureKeys.has(b)&&(d("WAWebABPropsGlobals").exposureKeys.add(b),d("WAWebABPropsGlobals").updateGlobalExpoKey());d("WAWebABPropsGlobals").accessedConfigs.add(a);d("WAWebApiAbPropConfig").setConfigAccessed(a)}b=i.get(a);return!c("gkx")("26258")&&(b==null?void 0:b.overriddenConfigValue)!=null?b.overriddenConfigValue:b==null?void 0:b.configValue}function f(){return Array.from(i.values())}function n(a){var b=!1;a.forEach(function(a){i.set(a.configCode,a),a.hasAccessed===!0&&(d("WAWebABPropsGlobals").accessedConfigs.add(a.configCode),a.configExpoKey!=null&&(d("WAWebABPropsGlobals").exposureKeys.add(a.configExpoKey),b=!0))});b&&d("WAWebABPropsGlobals").updateGlobalExpoKey();j=!0}function o(){i.clear(),d("WAWebABPropsGlobals").accessedConfigs.clear(),d("WAWebABPropsGlobals").exposureKeys.clear(),j=!1}g.getABPropConfigNameFromCode=a;g.initializeABPropsCache=e;g.getAllABPropConfigs=f;g.bulkCreateOrReplaceABPropConfigs=n;g.clearABPropConfigs=o}),98);
__d("WAWebEventSampling",["WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[EventSampling] override event sampling weight for ",": ",""]);h=function(){return a};return a}var i=null;function j(a){return i==null?null:i(a)}function a(a){var b=j(a);if(b!=null){d("WALogger").DEV(h(),a,b);return Math.abs(b)}return null}function b(a){i=a}g.getClientEventSamplingWeight=a;g.setGetEventSamplingConfigValueImpl=b}),98);
__d("WAWebSharedConstants",[],(function(a,b,c,d,e,f){a="__wa-mms";b="mms-type";f.IS_MMS_URL_SEARCH_PARAM=a;f.MMS_URL_MEDIA_TYPE_SEARCH_PARAM=b}),66);
__d("WAWebCryptoDecryptPartialMedia",["Promise","WALogger","WATypedArraysConcat","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["decryptPartialMedia:getEncryptedPadding encrypt error: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["decryptPartialMedia:getEncryptedPadding importKey error: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["decryptPartialMedia:decrypt decrypt error: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["decryptPartialMedia:decrypt importKey error: ",""]);l=function(){return a};return a}var m=16,n=10,o=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.ciphertext,c=a.iv;a=a.mediaKeys;a=a.encKey;c={name:"AES-CBC",iv:c};try{a=(yield self.crypto.subtle.importKey("raw",new Uint8Array(a),"AES-CBC",!1,["decrypt"])["catch"](function(a){d("WALogger").LOG(l(),String(a));throw a}));return self.crypto.subtle.decrypt(c,a,b)}catch(a){d("WALogger").LOG(k(),String(a));throw a}});return function(b){return a.apply(this,arguments)}}(),p=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.ciphertext;a=a.mediaKeys;a=a.encKey;b=b instanceof Uint8Array?b:new Uint8Array(b);b={name:"AES-CBC",iv:b.slice(0-m)};try{a=(yield self.crypto.subtle.importKey("raw",new Uint8Array(a),"AES-CBC",!1,["encrypt"])["catch"](function(a){d("WALogger").LOG(j(),String(a));return void 0}));var c=new Uint8Array([]);return self.crypto.subtle.encrypt(b,a,c)}catch(a){d("WALogger").LOG(i(),String(a));return void 0}});return function(b){return a.apply(this,arguments)}}(),q=function(a){var c=a.serverRangeStart,e=a.ciphertext;a=a.mediaKeys;var f=e instanceof Uint8Array?e:new Uint8Array(e);e=c===0;c=f.byteLength%m===0;var g=!c,i;e?i=new Uint8Array(a.iv):(i=f.slice(0,m),f=f.slice(m));g&&(f=f.slice(0,f.byteLength-n));return c?p({ciphertext:f,mediaKeys:a}).then(function(a){f=d("WATypedArraysConcat").concatTypedArrays(Uint8Array,[f,new Uint8Array(a)]);return{ciphertext:f,iv:i}}):(h||(h=b("Promise"))).resolve({ciphertext:f,iv:i})};a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.mediaKeys;a=a.ciphertext;a=(yield q({serverRangeStart:0,ciphertext:a,mediaKeys:b}));var c=a.ciphertext;a=a.iv;return o({ciphertext:c,iv:a,mediaKeys:b})});return function(b){return a.apply(this,arguments)}}();g.BLOCK_SIZE=m;g.HMAC_SIZE=n;g.decrypt=o;g.cleanupCiphertextAndIv=q;g.decryptPartialMedia=a}),98);
__d("WAWebUserPrefsIsLoggedIn",["WAWebUserPrefsMultiDevice"],(function(a,b,c,d,e,f,g){var h=!1;function a(){return d("WAWebUserPrefsMultiDevice").isRegistered()&&i()}function i(){return h}function b(a){h=a}g.isLoggedIn=a;g.setIsConnectedAsRegistered=b}),98);
__d("WAWebUserPrefsTabMutex",["WANullthrows","WAWebLocalStorage","WAWebPermanentStorage","WAWebUserPrefsKeys","WAWebUserPrefsStore"],(function(a,b,c,d,e,f,g){var h="x"+Math.round(Math.random()*1e9);function i(){return c("WAWebUserPrefsStore").getPSIgnoringCache(d("WAWebUserPrefsKeys").KEYS.WHATSAPP_MUTEX)}function a(a){a=a?h+":"+a:a;c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").KEYS.WHATSAPP_MUTEX,a,{storage:c("WAWebPermanentStorage")})}function b(){c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").KEYS.WHATSAPP_MUTEX,null,{storage:c("WAWebPermanentStorage")})}function e(a){a=a?JSON.parse(a):"";return a?a.toString().split(/:/).pop():a}function f(a){if(a.key!==d("WAWebUserPrefsKeys").KEYS.WHATSAPP_MUTEX)return!1;a=a.newValue||"";return!a.includes(h)?!0:!1}function j(){return(i()||"").includes(h)}function k(){var a={};a.wa_tab_src=h;c("WANullthrows")(c("WAWebLocalStorage")).setItem(d("WAWebUserPrefsKeys").KEYS.LOCAL_TAKEOVER_OK,JSON.stringify(a));c("WANullthrows")(c("WAWebLocalStorage")).removeItem(d("WAWebUserPrefsKeys").KEYS.LOCAL_TAKEOVER_OK)}function l(a){if(a.key!==d("WAWebUserPrefsKeys").KEYS.LOCAL_TAKEOVER_OK)return!1;a=a.newValue||"";return!a.includes(h)?!0:!1}function m(a){c("WAWebUserPrefsStore").setTS(d("WAWebUserPrefsKeys").KEYS.NO_TAKEOVER,a)}function n(){return!!c("WAWebUserPrefsStore").getTS(d("WAWebUserPrefsKeys").KEYS.NO_TAKEOVER)}g.THIS_TAB=h;g.getMutex=i;g.setMutex=a;g.removeMutex=b;g.parseMutex=e;g.mutexFilter=f;g.currentTabHasMutex=j;g.localTakeoverSuccess=k;g.takeoverFilter=l;g.setNoTakeover=m;g.getNoTakeover=n}),98);
__d("WAWebIsOfficialClient",["WALogger","WAWebUA","WAWebWamGlobals","gkx"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Cannot set ocVersion ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Cannot analyze UC ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Caller ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Caller ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["A caller is not found ",""]);l=function(){return a};return a}var m=function(){var a;return typeof process!=="undefined"&&((a=process.versions)==null?void 0:a.electron)!=null},n=function(){var a=typeof self!=="undefined"?self.navigator:null;return Boolean(a.webdriver)};a=function(){if(m()||n())return!1;return d("WAWebUA").UA.isChrome&&/HeadlessChrome/.test(window.navigator.userAgent)?!1:!0};var o=function(){try{var a=new Error();a=a.stack;var b=a.split("\n").filter(function(a){return Boolean(a.trim())}).pop();if(b==null){d("WALogger").WARN(l(),a).tags("uc");return!0}if(!b.includes(".whatsapp.com")){!c("gkx")("26258")?d("WALogger").WARN(k(),b).tags("uc").sendLogs("Unexpectedly detected UC"):d("WALogger").WARN(j(),b).tags("uc");return!1}}catch(a){d("WALogger").WARN(i(),a.stack).tags("uc")}return!0};b="webpackChunkwhatsapp_web_client";b in window||(window[b]=[]);var p=window[b];p!=null&&Object.defineProperty(window,b,{get:function(){if(!o())try{d("WAWebWamGlobals").Global.set({ocVersion:0})}catch(a){d("WALogger").WARN(h(),a.stack).tags("uc")}return p}});e=a();g.isLegitErrorStack=o;g.isOfficialClient=e}),98);
__d("WAWebWamEnumCrashType",[],(function(a,b,c,d,e,f){a=Object.freeze({CRASH:0,OOM:1,MAIN_THREAD_STALL_3_SECONDS:15,MAIN_THREAD_STALL_30_SECONDS:2,MAIN_THREAD_STALL_60_SECONDS:16,MAIN_THREAD_STALL_POKED:17,MAIN_THREAD_STALL_DEBUG:3,AUDIO_TRANSCODING_ERROR:4,VIDEO_TRANSCODING_ERROR:5,ANR:6,CRITICAL_EVENT:7,UNHANDLED_EXCEPTION:8,APP_CRASH:9,NATIVE_CRASH:10,UFAD:11,EXPERIMENTAL_UFAD_DETECTION:12,UX_BREAKING_EXCEPTION:13,UX_GRACEFUL_RECOVERY_EXCEPTION:14});f.CRASH_TYPE=a}),66);
__d("WAWebCrashLogWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumCrashType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({CrashLog:[494,{crashContext:[3,a.TYPES.STRING],crashCount:[5,a.TYPES.INTEGER],crashReason:[2,a.TYPES.STRING],crashType:[6,d("WAWebWamEnumCrashType").CRASH_TYPE],runningTasks:[16,a.TYPES.STRING]},[1,1,100],"regular"]},{CrashLog:[]});g.CrashLogWamEvent=b}),98);
__d("WAWebCrashlogConstants",["WAWebBuildConstants"],(function(a,b,c,d,e,f,g){a="https://crashlogs.whatsapp.net/wa_fls_upload_check";b="1063127757113399|745146ffa34413f9dbb5469f5370b7af";c="https://crashlogs.whatsapp.net/wa_clb_data";e=d("WAWebBuildConstants").DYN_ORIGIN+"web-contact-us";f=0;g.CLB_CHECK_URL=a;g.CLB_TOKEN=b;g.CLB_URL=c;g.TICKET_URL=e;g.UNIQUE_UPLOADS_ALLOWED_BEFORE_THROTTLE=f}),98);
__d("WAWebCrashlogUserAgent",["gkx"],(function(a,b,c,d,e,f,g){function a(){var a="web",b="unknown";c("gkx")("26259")?b="intern":c("gkx")("26268")?b="automation":c("gkx")("26258")&&(b="prod");return a+"_"+b}function b(a){var b=a.appVersion,c=a.browser;a=a.device;c="Web/"+c;return"WhatsApp/"+b+" "+c+" Device/"+a}g.getDistribution=a;g.getLogUserAgent=b}),98);
__d("WAWebLogLineSanitizer",[],(function(a,b,c,d,e,f){function a(a){return a.replace(/(\d){1,16}(\d{4}[@,:,-])/g,"...$2")}f.sanitizeLine=a}),66);
__d("WAMemoizeConditionally",[],(function(a,b,c,d,e,f){"use strict";function g(a,b){var c=function c(){for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];var g=b?b.apply(this,e):e[0];if(g==null)return a.apply(this,e);var h=c.cache;if(h.has(g))return h.get(g);var i=a.apply(this,e);c.cache=h.set(g,i)||h;return i};c.cache=new(g.Cache||Map)();return c}g.Cache=Map;f["default"]=g}),66);
__d("WAArrayInterleave",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){var c=[],d=a.length,e=b.length,f=Math.max(d,e);for(var g=0;g<f;g++)g<d&&c.push(a[g]),g<e&&c.push(b[g]);return c}f["default"]=a}),66);
__d("WAWebLoggerFormatMessage",["WAArrayInterleave"],(function(a,b,c,d,e,f,g){var h=4e3;function a(a,b,d,e){e===void 0&&(e=String);a=c("WAArrayInterleave")(a,b.map(e)).join("");b=d?h:Number.POSITIVE_INFINITY;a.length>b&&(a=a.slice(0,b/2)+("\n\n["+(a.length-b)+" truncated]\n\n")+a.slice(-b/2));return a}g["default"]=a}),98);
__d("WAWebLoggerOptimizer",["asyncToGeneratorRuntime"],(function(a,b,c,d,e,f){var g="==================================================EOU",h=4e3;function a(a,b,c){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){b===void 0&&(b=0);c===void 0&&(c=!1);var d=[];if(c){c=(yield a.logs.orderBy("timestamp").filter(function(a){return a.timestamp>=b}).reverse().until(function(a){return a.log.includes("[sendlogs]")},!0).toArray());for(var e=c.length-1;e>=0;e--){j(c[e],d);if(c[e].log.includes(g))break}}else yield a.logs.orderBy("timestamp").filter(function(a){return a.timestamp>=b}).each(function(a){j(a,d)});return d});return i.apply(this,arguments)}function j(a,b){a.log=a.log.slice(0,h),b.push(a)}f.END_OF_UPLOAD=g;f.TRIM_LENGTH=h;f.getTimeboxedAndTrimmedLogs=a}),66);
__d("WAWebLoggerUtils",[],(function(a,b,c,d,e,f){var g=!1;function a(){return g}function b(a){g=a}function c(a){if(a<=0)return!1;return a>=1?!0:Math.random()<a}f.isWaitingForUpload=a;f.setWaitingForUpload=b;f.passesSampling=c}),66);
__d("WAWebLoggerImpl",["Promise","WAMemoizeConditionally","WAShiftTimer","WAWeb-moment","WAWebLoggerFormatMessage","WAWebLoggerOptimizer","WAWebLoggerUtils","WAWebNormalizeStack","WAWebWAWCStorage","asyncToGeneratorRuntime","err","gkx"],(function(a,b,c,d,e,f,g){var h,i="trace",j=864e5*7;c("gkx")("26258")?e=5e3:e=15e4;f=e;var k="LTSXOo+_*-=.<^!#?".split("");function a(){return k[Math.round(Math.random()*(k.length-1))]}var l=a()+a()+a()+a(),m={};m[m.ALL=0]="all";m[m.INFO=1]="info";m[m.LOG=2]="log";m[m.WARN=3]="warn";m[m.ERROR=4]="error";m[m.OFF=5]="off";e=function(){function a(a,b,e){var f=this;e===void 0&&(e=void 0);this.localCursor=0;this.writeFrom=0;this.pending=void 0;this.timer=new(d("WAShiftTimer").ShiftTimer)(function(){return f.$1()});this.runningTimestamp=0;this.isTakeOver=!1;this.log=c("WAMemoizeConditionally")(function(a,b,d,e,g){b===void 0&&(b=!1);return function(h){for(var i=arguments.length,j=new Array(i>1?i-1:0),k=1;k<i;k++)j[k-1]=arguments[k];var l=c("WAWebLoggerFormatMessage")(h,j,!b);f.logImpl(a,l,d,e,g);return l}},function(a,b,c,d,e){return c||e?null:String(a)+String(Boolean(b))+String(Boolean(d))});this.logsDBProvider=a;this.logCapacityInDatabase=b;this.logs=new Array(b);this.microStep=1/this.logCapacityInDatabase;this.processTag=e}var e=a.prototype;e.logImpl=function(a,b,e,f,g){var h=Date.now(),j=c("WAWeb-moment")(h).locale("en").format("YYYY-MM-DD HH:mm:ss.SSS:");if(!c("gkx")("26258"))try{a===m.ERROR&&(this.$2&&this.$2(b))}catch(a){}var k="";e&&((g==null?void 0:g.includes(i))?k="\n"+e.stack.split("\n").slice(3).join("\n"):k="\n"+d("WAWebNormalizeStack").normalizeStack(e,!0));a=[n(a),f&&!d("WAWebLoggerUtils").isWaitingForUpload()?"sendlogs":null].concat((e=g)!=null?e:[],[this.processTag]).filter(Boolean).map(function(a){return"["+a+"]"}).join("");f=l+" "+j+(a?a+" ":"")+b+k;this.logs[this.localCursor]={m:f,t:h};this.localCursor=(this.localCursor+1)%this.logCapacityInDatabase;this.logs[this.localCursor]!=null&&(this.writeFrom=this.localCursor);if(this.isTakeOver)return;this.timer.debounceAndCap(250,1e3)};e.$1=function(){var a=this;if(this.pending||this.logs[this.writeFrom]==null||this.isTakeOver)return;this.pending=this.logsDBProvider().then(function(c){return c.transaction("rw",c.logs,b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b,d=(yield c.logs.orderBy("count").last());d||(d=(yield c.logs.orderBy("timestamp").last()));var e=d?d.line+1:0;b=((b=d)==null?void 0:b.count)?d.count+1:e;while(a.logs[a.writeFrom]!=null){d=a.logs[a.writeFrom];a.logs[a.writeFrom]=void 0;a.writeFrom=(a.writeFrom+1)%a.logCapacityInDatabase;a.runningTimestamp=d.t<=a.runningTimestamp?a.runningTimestamp+a.microStep:d.t;c.logs.put({line:e++%a.logCapacityInDatabase,log:d.m,timestamp:a.runningTimestamp,count:b++})}}))}).then(function(){a.logs[a.writeFrom]!=null&&a.timer.debounceAndCap(250,1e3)})["catch"](function(b){!c("gkx")("26258")&&a.$2&&a.$2(b.message)})["finally"](function(){a.pending=void 0})};e.getLogs=function(a,e){var f=this;a===void 0&&(a=!1);e===void 0&&(e=Date.now()-j);var g=[];this.pending&&g.push(this.pending);this.timer.isScheduled()&&(this.timer.forceRunNow(),this.pending&&g.push(this.pending));return(h||(h=b("Promise"))).all(g).then(function(){return f.logsDBProvider()}).then(function(b){return d("WAWebLoggerOptimizer").getTimeboxedAndTrimmedLogs(b,e,a)}).then(function(a){return a.map(function(a){return a.log})})["catch"](function(a){!c("gkx")("26258")&&f.$2&&f.$2(a.message);return f.logs.filter(Boolean).map(function(a){return a.m})})};e.clearLogs=function(){var a=this;return this.logsDBProvider().then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield a.logs.clear()});return function(b){return a.apply(this,arguments)}}())["catch"](function(){})["finally"](function(){a.localCursor=0,a.writeFrom=0,a.logs=new Array(a.logCapacityInDatabase)})};e.logUncaughtError=function(a,b){var d=a instanceof Error&&a.stack?a:void 0,e;d?e=String(a):e=b?"unhandled-rejection: "+String(a):"Error: "+String(a);this.logImpl(m.ERROR,e,d,!0,["uncaught"]);if(!c("gkx")("26258"))var f;if(b!=null){a=String(b);this.logImpl(m.WARN,a);!c("gkx")("26258")}return e};e.onTakeOver=function(){this.isTakeOver=!0};e.registerErrorNotificationListener=function(a){this.$2=a};return a}();function n(a){switch(a){case m.INFO:case m.LOG:case m.WARN:case m.ERROR:return m[a];default:throw c("err")("Unexpected numeric log level: "+a)}}a=new e(function(){return c("WAWebWAWCStorage").idb()},f);f=a.log;g.STACK_TRACE_TAG=i;g.LoggerImpl=e;g.Logger=a;g.log=f}),98);
__d("WAWebPriorLogs",["$InternalEnum","Promise","WALogger","WATimeUtils","WAWebSchemaSyncdLogs","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["prior logs: error while writing to prior logs: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["prior logs: error while printing fatal logs: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["\r\n\r\nprior logs: category ",": \r\n\r\n"],["\\r\\n\\r\\nprior logs: category ",": \\r\\n\\r\\n"]);l=function(){return a};return a}var m=b("$InternalEnum")({Empty:"",Regular:"regular",RegularLow:"regular_low",RegularHigh:"regular_high",CriticalBlock:"critical_block",CriticalUnblockLow:"critical_unblock_low"}),n=new Map(),o=90,p=80;function q(a){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;b=(b=n.get(a))!=null?b:0;n.set(a,b+1);if(b%o===0){b=(yield d("WAWebSchemaSyncdLogs").getSyncdLogsTable().equals(["collection"],a));if(b.length<p)return;a=b.sort(function(a,b){return a.ts-b.ts}).slice(0,b.length-p).map(function(a){return a.id});yield d("WAWebSchemaSyncdLogs").getSyncdLogsTable().bulkRemove(a)}});return r.apply(this,arguments)}function a(a,b){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{yield q(a),yield d("WAWebSchemaSyncdLogs").getSyncdLogsTable().bulkCreate([{collection:a,log:b,ts:d("WATimeUtils").unixTimeMs()}])}catch(a){d("WALogger").ERROR(i(),a)}});return s.apply(this,arguments)}c=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=[].concat(Array.from(m.members()),[""]).map(function(a){return m.cast(a)}).filter(Boolean);return t(a)});return function(){return a.apply(this,arguments)}}();var t=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{a=a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebSchemaSyncdLogs").getSyncdLogsTable().equals(["collection"],a));b=b.filter(function(a){return d("WATimeUtils").happenedWithin(d("WATimeUtils").castMilliSecondsToUnixTime(a.ts),d("WATimeUtils").DAY_MILLISECONDS*60)});b=b.map(function(a){return d("WATimeUtils").toHttpHeaderDate(d("WATimeUtils").castMilliSecondsToUnixTime(a.ts))+": "+a.log+"\r\n"});d("WALogger").LOG(l(),a);a=20;for(var c=0;c<b.length;c+=a)d("WALogger").LOG(k(),b.slice(c,c+a))});return function(b){return a.apply(this,arguments)}}());yield (h||(h=b("Promise"))).all((a=a)!=null?a:[])}catch(a){d("WALogger").ERROR(j(),a)}});return function(b){return a.apply(this,arguments)}}();g.WAWebLogCategory=m;g.writePriorLog=a;g.printAllPriorLogs=c;g.printPriorLogs=t}),98);
__d("WAWebWamEnumPsCrashType",[],(function(a,b,c,d,e,f){a=Object.freeze({CRASH:0,OOM:1,MAIN_THREAD_STALL_30_SECONDS:2,MAIN_THREAD_STALL_DEBUG:3,AUDIO_TRANSCODING_ERROR:4,VIDEO_TRANSCODING_ERROR:5,ANR:6,CRITICAL_EVENT:7,UNHANDLED_EXCEPTION:8,APP_CRASH:9,NATIVE_CRASH:10,UFAD:11});f.PS_CRASH_TYPE=a}),66);
__d("WAWebCrashlog",["$InternalEnum","Promise","WALogger","WAWebBrokerGlobalAppState","WAWebBuildConstants","WAWebCrashLogWamEvent","WAWebCrashlogConstants","WAWebCrashlogUserAgent","WAWebGlobals","WAWebLogLineSanitizer","WAWebLoggerImpl","WAWebLoggerOptimizer","WAWebLoggerUtils","WAWebMiscBrowserUtils","WAWebPriorLogs","WAWebRuntimeEnvironmentUtils","WAWebURLUtils","WAWebUserPrefsMeUser","WAWebWamEnumPsCrashType","asyncToGeneratorRuntime","cr:4722","err","gkx","lodash"],(function(a,b,c,d,e,f,g){var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Crash log sendLogs failed, ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Crashlog:failed to parse response from upload check ",", will perform default upload"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Crashlog:doUpload server configured sampling check w/rate: "," prevented upload"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Crashlog:doUpload skipping sampling check"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Crashlog:doUpload aborting crashlog upload due to 403 check response"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Crashlog:doUpload code of "," from "," was unexpected, expected values are: ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["reason for logs: ",""]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["wa:uploadLogs hasTaggedMessage"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["wa:uploadLogs buildId: ",""]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["wa:uploadLogs distribution: ",""]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["wa:uploadLogs url: ",""]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["wa:uploadLogs appId: ",""]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["wa:uploadLogs webPlatform: ",""]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose(["wa:uploadLogs platform: ",""]);x=function(){return a};return a}function y(){var a=babelHelpers.taggedTemplateLiteralLoose(["wa:uploadLogs userAgent: ",""]);y=function(){return a};return a}function z(){var a=babelHelpers.taggedTemplateLiteralLoose(["wa:uploadLogs ref: ",""]);z=function(){return a};return a}function A(){var a=babelHelpers.taggedTemplateLiteralLoose(["=================================================="]);A=function(){return a};return a}function B(){var a=babelHelpers.taggedTemplateLiteralLoose(["Crashlog:upload client sampling check w/rate: "," prevented upload"]);B=function(){return a};return a}function C(){var a=babelHelpers.taggedTemplateLiteralLoose(["wa:uploadLogs error uploading: ",""]);C=function(){return a};return a}function D(){var a=babelHelpers.taggedTemplateLiteralLoose(["wa:uploadLogs using throttle"]);D=function(){return a};return a}function E(){var a=babelHelpers.taggedTemplateLiteralLoose(["wa:uploadLogs reason already uploaded, skipping"]);E=function(){return a};return a}function a(){var b=babelHelpers.taggedTemplateLiteralLoose(["wa:uploadLogs squelched logs"]);a=function(){return b};return b}function F(){var a=babelHelpers.taggedTemplateLiteralLoose(["wa:uploadLogs error logging wam event: ",""]);F=function(){return a};return a}function G(){var a=babelHelpers.taggedTemplateLiteralLoose(["wa:uploadLogs error during wam commit: ",""]);G=function(){return a};return a}var H=function(a){return new(i||(i=b("Promise")))(function(b){return self.setTimeout(b,a)})},I,J,K=b("$InternalEnum")({CRASHLOG:"crashlog",SUPPORT:"support"}),L="server-requested",M="manual-upload",N="user-report",O={electron_native:(h=d("WAWebWamEnumPsCrashType")).PS_CRASH_TYPE.NATIVE_CRASH,uncaught_error:h.PS_CRASH_TYPE.UNHANDLED_EXCEPTION,unhandled_promise:h.PS_CRASH_TYPE.UNHANDLED_EXCEPTION,sad:h.PS_CRASH_TYPE.CRITICAL_EVENT,logout:h.PS_CRASH_TYPE.APP_CRASH},P=b("$InternalEnum")({ONLY_EXCEPTION:"only_exception"}),Q=100,R=new Map(),S={shouldHitCheckEndpoint:function(){return!1},expectedCodes:[],appendToFormDataForCheck:function(a){},appendToFormDataForUpload:function(a,b){},shouldUseLightWeightLogs:function(a){return!1}},T={shouldHitCheckEndpoint:function(){return!0},expectedCodes:[200,403],appendToFormDataForCheck:function(a,b){a.append("reason",b)},appendToFormDataForUpload:function(a,b){},shouldUseLightWeightLogs:function(a){return!1}},aa={shouldHitCheckEndpoint:function(){return!0},expectedCodes:[200,403],appendToFormDataForCheck:function(a,b){a.append("support_exception_only_upload","true"),a.append("reason",b)},appendToFormDataForUpload:function(a,b){b&&b.upload===P.ONLY_EXCEPTION&&a.append("exception_only_upload","true")},shouldUseLightWeightLogs:function(a){return a?a.upload===P.ONLY_EXCEPTION:!1}};function ba(a,b,d){if(!c("gkx")("26258")&&a||d)return S;return b?aa:T}h=72e5;var U=c("lodash").throttle(X,h,{trailing:!1});function e(a){I=a}function f(a){J=a}function V(a){return W.apply(this,arguments)}function W(){W=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a.reason;e=e===void 0?"reason-unspecified":e;var f=a.immediate;f=f===void 0?!1:f;var g=a.logType;g=g===void 0?K.CRASHLOG:g;var h=a.isHighPri;h=h===void 0?!1:h;var j=a.hasTaggedMessage;j=j===void 0?!1:j;var k=a.ticketId,l=a.clientSamplingRate;l=l===void 0?1:l;var m=a.tags;m=m===void 0?[]:m;a=a.fromTimestamp;if(c("WAWebBrokerGlobalAppState").isLogoutInProgress)return(i||(i=b("Promise"))).resolve();g===K.SUPPORT&&(yield d("WAWebPriorLogs").printAllPriorLogs());m=m;J&&(yield J())&&(m=m.concat("web-joined-beta"));d("WAWebRuntimeEnvironmentUtils").isWorker()&&(m=m.concat("service-worker"));l>0&&l<1&&(m=m.concat(["sampled",l.toString()]));if(R.size<=Q){var n=R.get(e);!n?R.set(e,{count:1,uploaded:!1}):n.count++}try{n=new(d("WAWebCrashLogWamEvent").CrashLogWamEvent)();n.crashReason=e;var o=m.find(function(a){return O[a]});o!=null&&(n.crashType=O[o]);m.length&&(n.crashContext=m.join(","));n.crashCount=(o=(o=R.get(e))==null?void 0:o.count)!=null?o:0;n.commitAndWaitForFlush()["catch"](function(a){d("WALogger").LOG(G(),a)})}catch(a){d("WALogger").LOG(F(),a)}if(d("WAWebLoggerUtils").isWaitingForUpload())return(i||(i=b("Promise"))).resolve();d("WAWebLoggerUtils").setWaitingForUpload(!0);if(d("WAWebLoggerUtils").passesSampling(l)){o=X;if(!h){n=R.get(e);if(n==null?void 0:n.uploaded){d("WALogger").LOG(E());d("WAWebLoggerUtils").setWaitingForUpload(!1);return}n&&(n.uploaded=!0);R.size>d("WAWebCrashlogConstants").UNIQUE_UPLOADS_ALLOWED_BEFORE_THROTTLE&&(d("WALogger").LOG(D()),o=U)}n=ba(h,j,e===L);try{o=(yield o({isHighPri:h,immediate:f,logType:g,ticketId:k,uploadStrategy:n,tags:m,reason:e,hasTaggedMessage:j,fromTimestamp:a}));d("WAWebLoggerUtils").setWaitingForUpload(!1);return o}catch(a){d("WAWebLoggerUtils").setWaitingForUpload(!1);d("WALogger").LOG(C(),a);return}}else d("WAWebLoggerUtils").setWaitingForUpload(!1),d("WALogger").LOG(B(),l)});return W.apply(this,arguments)}function X(a){return Y.apply(this,arguments)}function Y(){Y=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e,f=a.isHighPri;f=f===void 0?!1:f;var g=a.immediate,h=a.logType,i=a.ticketId,j=a.uploadStrategy,B=a.tags;B=B===void 0?[]:B;var C=a.reason;C=C===void 0?"reason-unspecified":C;var D=a.hasTaggedMessage;D=D===void 0?!1:D;a=a.fromTimestamp;!c("gkx")("26256")&&!c("gkx")("26258")&&(b("cr:4722")==null?void 0:b("cr:4722").logDbReadWriteStats(!0));var E=I?I():{platform:void 0,ref:void 0};d("WALogger").LOG(A());d("WALogger").LOG(z(),(e=E.ref)!=null?e:"no conn");d("WALogger").LOG(y(),navigator.userAgent);d("WALogger").LOG(x(),(e=E.platform)!=null?e:"no platform");d("WALogger").LOG(w(),d("WAWebBuildConstants").FLB_PLATFORM||"web");d("WALogger").LOG(v(),d("WAWebBuildConstants").FB_APP_ID);d("WALogger").LOG(u(),location.href);d("WALogger").LOG(t(),d("WAWebCrashlogUserAgent").getDistribution());d("WALogger").LOG(s(),d("WAWebBuildConstants").BUILD_ID||"0");D&&d("WALogger").LOG(r());d("WALogger").LOG(q(),C);d("WALogger").LOG(p(),d("WAWebLoggerOptimizer").END_OF_UPLOAD);yield H(g?0:1e3);var F;if(j.shouldHitCheckEndpoint()){E=Z({isHighPri:f});j.appendToFormDataForCheck(E,C);F=(yield self.fetch(ca(h),{method:"POST",body:E}));if(!j.expectedCodes.includes(F.status)){d("WALogger").LOG(o(),F.status,d("WAWebCrashlogConstants").CLB_CHECK_URL,j.expectedCodes.toString());return}if(F.status===403){d("WALogger").LOG(n());return}}else d("WALogger").LOG(m());e=null;if(F)try{e=JSON.parse(yield F.text());if(((D=e)==null?void 0:(g=D.config)==null?void 0:g.sampling)!=null&&(e.config.sampling===0||Math.random()*e.config.sampling>1)){d("WALogger").LOG(l(),e.config.sampling);return}}catch(a){d("WALogger").LOG(k(),String(a))}E=Z({isHighPri:f});j.appendToFormDataForUpload(E,e);D=(yield d("WAWebLoggerImpl").Logger.getLogs(j.shouldUseLightWeightLogs(e),C===L?0:a));c("gkx")("26258")&&(D=D.map(d("WAWebLogLineSanitizer").sanitizeLine));g=D.join("\n");f=new Blob([g],{type:"text/plain"});E.append("file",f,"logs.txt");B.length&&E.append("tags",B.join(","));i&&E.append("ticket_id",i);j=da(h);e=(yield self.fetch(j,{method:"POST",body:E}));if(e.status!==200)throw c("err")("Status code of "+e.status+" from "+j+" was unexpected, expected 200");return e.headers.get("X-Uploaded-File-Id")});return Y.apply(this,arguments)}function Z(a){a=a.isHighPri;var b=new FormData();(!c("gkx")("26258")||a)&&b.append("forced","true");a=d("WAWebRuntimeEnvironmentUtils").isWorker()&&!d("WAWebGlobals").areGlobalsReady()?void 0:d("WAWebUserPrefsMeUser").getMe();a&&b.append("from_jid",a.toString());a=c("WAWebMiscBrowserUtils").info();a=d("WAWebCrashlogUserAgent").getLogUserAgent({device:a.os,browser:a.ua,appVersion:d("WAWebBuildConstants").VERSION_BASE});b.append("agent",a);b.append("app_id",d("WAWebBuildConstants").FB_APP_ID);b.append("build_id",d("WAWebBuildConstants").BUILD_ID);return b}function ca(a){return c("WAWebURLUtils").build(d("WAWebCrashlogConstants").CLB_CHECK_URL,{type:String(a),access_token:d("WAWebCrashlogConstants").CLB_TOKEN})}function da(a){return c("WAWebURLUtils").build(d("WAWebCrashlogConstants").CLB_URL,{type:String(a),access_token:d("WAWebCrashlogConstants").CLB_TOKEN})}function ea(a,b,c){return $.apply(this,arguments)}function $(){$=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){if(d("WAWebLoggerImpl").Logger.isTakeOver)return;try{yield V({reason:a,hasTaggedMessage:!0,clientSamplingRate:(a=b)!=null?a:1,tags:c})}catch(a){d("WALogger").ERROR(j(),a)}});return $.apply(this,arguments)}function fa(){U.cancel(),R.clear()}g.LogType=K;g.SERVER_REQUESTED=L;g.MANUAL_UPLOAD=M;g.USER_REPORT=N;g.registerCrashlogUploadInformationalLoggingFunction=e;g.registerCrashlogUploadIsUserInExternalBetaFunction=f;g.upload=V;g.sendLogs=ea;g.reset=fa}),98);
__d("WAWebPwaDocumentMetadataUtils",["WAWebRuntimeEnvironmentUtils","gkx"],(function(a,b,c,d,e,f,g){var h="",i=-1,j;d("WAWebRuntimeEnvironmentUtils").isWorker()||(h=document.title);function a(a){a===void 0&&(a=null),a!=null&&(h=a),k(h)}function k(a){l()?document.title=" ":(self.clearTimeout(j),document.title+=" ",j=self.setTimeout(function(){document.title=a},0))}function b(a){a!=null&&(i=a),c("gkx")("26264")&&(l==null?void 0:l())&&"setAppBadge"in navigator&&(i===-1||i===0?navigator.clearAppBadge()["catch"](function(a){}):navigator.setAppBadge(i)["catch"](function(a){}))}function l(){return"matchMedia"in self?window.matchMedia("(display-mode: standalone)").matches:!1}g.setDocumentTitle=a;g.setAppBadge=b;g.isCurrentWebSessionInsidePwa=l}),98);
__d("WAWebUpdaterVersion",["WACustomError","WAWebBuildConstants"],(function(a,b,c,d,e,f,g){var h=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}return a}(d("WACustomError").customError("InvalidVersion"));b=function(){function a(a){a=a.split(".");if(a.length!==3)throw new h("Version format does not contain 3 numbers.");this.primary=Number.parseInt(a[0],10);this.secondary=Number.parseInt(a[1],10);this.tertiary=Number.parseInt(a[2],10);if(Number.isNaN(this.primary)||Number.isNaN(this.secondary)||Number.isNaN(this.tertiary))throw new h("Version contains a non-parseable string.")}var b=a.prototype;b.lt=function(b){b=b;typeof b==="string"&&(b=new a(b));return this.primary<b.primary||this.primary===b.primary&&this.secondary<b.secondary||this.primary===b.primary&&this.secondary===b.secondary&&this.tertiary<b.tertiary};b.equals=function(b){b=b;if(b==null||b==="")return!1;typeof b==="string"&&(b=new a(b));return this.primary===b.primary&&this.secondary===b.secondary&&this.tertiary===b.tertiary};b.toString=function(){return this.primary+"."+this.secondary+"."+this.tertiary};return a}();function a(a){return a.replace(/\.[di]$/,"")}c=a(d("WAWebBuildConstants").VERSION_STR);g.Version=b;g.sanitizeVersionStr=a;g.SANITIZED_VERSION_STR=c}),98);
__d("WAWebWamClientErrorsWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({WamClientErrors:[1144,{isFromWamsys:[27,a.TYPES.BOOLEAN],wamClientBufferDropErrorCount:[28,a.TYPES.INTEGER],wamClientBufferFetchErrorCount:[29,a.TYPES.INTEGER],wamClientBufferStoreErrorCount:[30,a.TYPES.INTEGER],wamClientCorruptedBuffersCount:[42,a.TYPES.INTEGER],wamClientDroppedEventCount:[2,a.TYPES.INTEGER],wamClientDroppedEventCountNoEnoughStorage:[41,a.TYPES.INTEGER],wamClientDroppedEventSize:[3,a.TYPES.INTEGER],wamClientErrorFlags:[1,a.TYPES.BOOLEAN],wamClientMetadataReadErrorCount:[37,a.TYPES.INTEGER],wamClientMetadataWriteErrorCount:[38,a.TYPES.INTEGER],wamClientPrivateDroppedEventCount:[24,a.TYPES.INTEGER],wamClientPrivateDroppedEventSize:[25,a.TYPES.INTEGER],wamClientPrivateRealtimeDroppedEventCount:[34,a.TYPES.INTEGER],wamClientPrivateRealtimeDroppedEventSize:[35,a.TYPES.INTEGER],wamClientPrivateRealtimeRejectedEventCount:[36,a.TYPES.INTEGER],wamClientPrivateRejectedEventCount:[31,a.TYPES.INTEGER],wamClientRealtimeDroppedEventCount:[22,a.TYPES.INTEGER],wamClientRealtimeDroppedEventSize:[23,a.TYPES.INTEGER],wamClientRealtimeRejectedEventCount:[32,a.TYPES.INTEGER],wamClientRejectedEventCount:[33,a.TYPES.INTEGER],wamErrorBadCurrentEventBufferChecksum:[18,a.TYPES.BOOLEAN],wamErrorBadEventBuffer:[16,a.TYPES.BOOLEAN],wamErrorBadFileHeader:[15,a.TYPES.BOOLEAN],wamErrorBadFileSize:[8,a.TYPES.BOOLEAN],wamErrorBadHeaderChecksum:[17,a.TYPES.BOOLEAN],wamErrorBadRotatedEventBufferChecksum:[19,a.TYPES.BOOLEAN],wamErrorCloseFile:[11,a.TYPES.BOOLEAN],wamErrorCreateWamFile:[14,a.TYPES.BOOLEAN],wamErrorFseekFile:[9,a.TYPES.BOOLEAN],wamErrorOpenFile:[10,a.TYPES.BOOLEAN],wamErrorOpenPsUploadQueueFile:[26,a.TYPES.BOOLEAN],wamErrorOpenWamFile:[13,a.TYPES.BOOLEAN],wamErrorPersistence:[20,a.TYPES.BOOLEAN],wamErrorReadFile:[7,a.TYPES.BOOLEAN],wamErrorRemoveFile:[12,a.TYPES.BOOLEAN],wamErrorWriteEventBuffer:[6,a.TYPES.BOOLEAN],wamErrorWriteFile:[4,a.TYPES.BOOLEAN],wamErrorWriteHeader:[5,a.TYPES.BOOLEAN],wamFirstErrorReadMetadata:[39,a.TYPES.BOOLEAN],wamFirstErrorWriteMetadata:[40,a.TYPES.BOOLEAN]},[1,1,1],"regular"]},{WamClientErrors:[]});g.WamClientErrorsWamEvent=b}),98);
__d("WAWebWamConstants",[],(function(a,b,c,d,e,f){a=10;b=5e4;c=5;d=300;e=100;var g=64e3;f.PENDING_DELAY_IN_SECONDS=a;f.WAM_MAX_BUFFER_SIZE=b;f.WAM_PROTOCOL_VERSION=c;f.WAM_ROTATE_INTERVAL_IN_SECONDS=d;f.WAM_WORKER_DATA_BATCH_SIZE=e;f.WAM_MAX_BUFFER_SIZE_FOR_UPLOAD=g}),66);
__d("WAWebWamEnumWebcWindowNavigatorWebdriverType",[],(function(a,b,c,d,e,f){a=Object.freeze({FALSE:0,TRUE:1,UNDEFINED:2});f.WEBC_WINDOW_NAVIGATOR_WEBDRIVER_TYPE=a}),66);
__d("WAWebWamFingerprint",[],(function(a,b,c,d,e,f){function g(){var a=Object.getOwnPropertyNames(window),b=Object.getOwnPropertyNames(document),c=Array.prototype.slice.call(window.document.documentElement.attributes),d=["__webdriver_evaluate","__selenium_evaluate","__webdriver_script_function","__webdriver_script_func","__webdriver_script_fn","__fxdriver_evaluate","__driver_unwrapped","__webdriver_unwrapped","__driver_evaluate","__selenium_unwrapped","__fxdriver_unwrapped"],e=["_phantom","__nightmare","_selenium","callPhantom","callSelenium","_Selenium_IDE_Recorder"],f=["selenium","webdriver","driver"];function g(a,b){var c={};a.map(function(a){c[a]=!!b.includes(a)});return c}e=g(e,a);a=g(d,b);d=g(f,c);e.wd=window.navigator.webdriver;return{wKeys:e,dKeys:a,dElKeys:d}}a={getAutoToolsProperties:function(){return{data:g()}}};f["default"]=a}),66);
__d("WAWebWebcFingerprintWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumWebcWindowNavigatorWebdriverType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({WebcFingerprint:[1704,{webcCanvasFingerprint:[25,a.TYPES.STRING],webcDocumentDriverEvaluate:[9,a.TYPES.BOOLEAN],webcDocumentDriverUnwrapped:[7,a.TYPES.BOOLEAN],webcDocumentElementAttrDriver:[14,a.TYPES.BOOLEAN],webcDocumentElementAttrSelenium:[12,a.TYPES.BOOLEAN],webcDocumentElementAttrWebdriver:[13,a.TYPES.BOOLEAN],webcDocumentFxdriverEvaluate:[6,a.TYPES.BOOLEAN],webcDocumentFxdriverUnwrapped:[11,a.TYPES.BOOLEAN],webcDocumentSeleniumEvaluate:[2,a.TYPES.BOOLEAN],webcDocumentSeleniumUnwrapped:[10,a.TYPES.BOOLEAN],webcDocumentWebdriverEvaluate:[1,a.TYPES.BOOLEAN],webcDocumentWebdriverScriptFn:[5,a.TYPES.BOOLEAN],webcDocumentWebdriverScriptFunc:[4,a.TYPES.BOOLEAN],webcDocumentWebdriverScriptFunction:[3,a.TYPES.BOOLEAN],webcDocumentWebdriverUnwrapped:[8,a.TYPES.BOOLEAN],webcWebglFingerprint:[24,a.TYPES.STRING],webcWebglRenderer:[23,a.TYPES.STRING],webcWebglVendor:[22,a.TYPES.STRING],webcWindowSeleniumIdeRecorder:[20,a.TYPES.BOOLEAN],webcWindowCallphantom:[18,a.TYPES.BOOLEAN],webcWindowCallselenium:[19,a.TYPES.BOOLEAN],webcWindowNavigatorWebdriver:[21,d("WAWebWamEnumWebcWindowNavigatorWebdriverType").WEBC_WINDOW_NAVIGATOR_WEBDRIVER_TYPE],webcWindowNightmare:[16,a.TYPES.BOOLEAN],webcWindowPhantom:[15,a.TYPES.BOOLEAN],webcWindowSelenium:[17,a.TYPES.BOOLEAN]},[1,1,1],"regular"]},{WebcFingerprint:[]});g.WebcFingerprintWamEvent=b}),98);
__d("WAWebWamFingerprintReporter",["WAWebWamEnumWebcWindowNavigatorWebdriverType","WAWebWamFingerprint","WAWebWebcFingerprintWamEvent"],(function(a,b,c,d,e,f,g){function a(){var a=c("WAWebWamFingerprint").getAutoToolsProperties();a={webcDocumentWebdriverEvaluate:a.data.dKeys.__webdriver_evaluate,webcDocumentSeleniumEvaluate:a.data.dKeys.__selenium_evaluate,webcDocumentWebdriverScriptFunction:a.data.dKeys.__webdriver_script_function,webcDocumentWebdriverScriptFunc:a.data.dKeys.__webdriver_script_func,webcDocumentWebdriverScriptFn:a.data.dKeys.__webdriver_script_fn,webcDocumentFxdriverEvaluate:a.data.dKeys.__fxdriver_evaluate,webcDocumentDriverUnwrapped:a.data.dKeys.__driver_unwrapped,webcDocumentWebdriverUnwrapped:a.data.dKeys.__webdriver_unwrapped,webcDocumentDriverEvaluate:a.data.dKeys.__driver_evaluate,webcDocumentSeleniumUnwrapped:a.data.dKeys.__selenium_unwrapped,webcDocumentFxdriverUnwrapped:a.data.dKeys.__fxdriver_unwrapped,webcDocumentElementAttrSelenium:a.data.dElKeys.selenium,webcDocumentElementAttrWebdriver:a.data.dElKeys.webdriver,webcDocumentElementAttrDriver:a.data.dElKeys.driver,webcWindowPhantom:a.data.wKeys._phantom,webcWindowNightmare:a.data.wKeys.__nightmare,webcWindowSelenium:a.data.wKeys._selenium,webcWindowCallphantom:a.data.wKeys.callPhantom,webcWindowCallselenium:a.data.wKeys.callSelenium,webcWindowSeleniumIdeRecorder:a.data.wKeys._Selenium_IDE_Recorder,webcWindowNavigatorWebdriver:a.data.wKeys.wd===!0?d("WAWebWamEnumWebcWindowNavigatorWebdriverType").WEBC_WINDOW_NAVIGATOR_WEBDRIVER_TYPE.TRUE:a.data.wKeys.wd===!1?d("WAWebWamEnumWebcWindowNavigatorWebdriverType").WEBC_WINDOW_NAVIGATOR_WEBDRIVER_TYPE.FALSE:d("WAWebWamEnumWebcWindowNavigatorWebdriverType").WEBC_WINDOW_NAVIGATOR_WEBDRIVER_TYPE.UNDEFINED};a=new(d("WAWebWebcFingerprintWamEvent").WebcFingerprintWamEvent)(a);a.commit()}g.logFingerprintToWam=a}),98);
__d("WAWebWamEnumPsIdAction",[],(function(a,b,c,d,e,f){a=Object.freeze({CREATED:1,ROTATED:2,DELETED:3});f.PS_ID_ACTION=a}),66);
__d("WAQplUploader",["WALogger","WAPromiseDelays","WAPromiseRetryLoop","WAQplTypes","regeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["QPL Uploader uploadChunk, retriable error: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["QPL Uploader, sending rows ","-",", count ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["QPL Uploader, error during upload session, error: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["QPL Uploader upload session failed, error: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["QPL Uploader, done upload."]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["QPL Uploader, uploading "," rows"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["QPL Uploader, upload triggered, attempt ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["QPL Uploader, sleeping between uploads for "," ms"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["QPL Uploader, sleeping prior to start for "," ms"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["QPL Uploader, start"]);q=function(){return a};return a}var r={minTimeout:1e3,maxTimeout:1e4,retries:5,type:"exponential"},s=100,t={MAX_COUNT:4,MIN_DELAY:1*1e3*60,MAX_DELAY:15*1e3*60},u=5*60,v=24*60*60,w,x,y;function a(a,c){var e,f,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:w=c.healthLogger;x=c.storageApi;if(!y){j.next=4;break}return j.abrupt("return");case 4:d("WALogger").DEV(q());y={sendEvents:a.sendEvents,isQplEnabled:a.isQplEnabled,startDelayInMs:1e3*((e=a.startDelayInSeconds)!=null?e:u),intervalInMs:1e3*((f=a.intervalInSeconds)!=null?f:v),minRetryDelayInMs:1e3*((g=a.minRetryDelayInSeconds)!=null?g:t.MIN_DELAY),maxRetryDelayInMs:1e3*((h=a.maxRetryDelayInSeconds)!=null?h:t.MAX_DELAY),maxRetryAttemptsCount:(i=a.maxRetryAttemptsCount)!=null?i:t.MAX_COUNT};d("WALogger").DEV(p(),y.startDelayInMs);j.next=9;return b("regeneratorRuntime").awrap(d("WAPromiseDelays").delayMs(y.startDelayInMs));case 9:j.next=11;return b("regeneratorRuntime").awrap(B());case 11:z();case 12:case"end":return j.stop()}},null,this)}function c(){return B()}function z(){d("WALogger").DEV(o(),y.intervalInMs),setTimeout(function(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:a.next=2;return b("regeneratorRuntime").awrap(B());case 2:z();case 3:case"end":return a.stop()}},null,this)},y.intervalInMs)}function A(){var a;return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:a=y.minRetryDelayInMs+Math.floor(Math.random()*(y.maxRetryDelayInMs-y.minRetryDelayInMs));c.next=3;return b("regeneratorRuntime").awrap(d("WAPromiseDelays").delayMs(a));case 3:case"end":return c.stop()}},null,this)}function B(a){var c,e,f,g,h,i,o;return b("regeneratorRuntime").async(function(p){while(1)switch(p.prev=p.next){case 0:a===void 0&&(a=0);if((c=y)==null?void 0:c.isQplEnabled()){p.next=3;break}return p.abrupt("return");case 3:d("WALogger").DEV(n(),a);p.prev=4;p.next=7;return b("regeneratorRuntime").awrap(x.getRowCount());case 7:e=p.sent,d("WALogger").DEV(m(),e),f=0;case 10:if(!(f<e)){p.next=23;break}p.next=13;return b("regeneratorRuntime").awrap(x.getFromBottom(s));case 13:g=p.sent;p.next=16;return b("regeneratorRuntime").awrap(C(g));case 16:h=g[0].id||0;i=g[g.length-1].id||0;p.next=20;return b("regeneratorRuntime").awrap(x.deleteRange(h,i));case 20:f+=g.length;p.next=10;break;case 23:d("WALogger").DEV(l());p.next=37;break;case 26:p.prev=26;p.t0=p["catch"](4);d("WALogger").DEV(k(),p.t0);if(!(a<y.maxRetryAttemptsCount)){p.next=35;break}p.next=32;return b("regeneratorRuntime").awrap(A());case 32:B(a+1);p.next=37;break;case 35:d("WALogger").ERROR(j(),p.t0).verbose().devConsole(p.t0).sendLogs("QPL Uploader upload session failed"),(o=w)==null?void 0:o.errorUploadingChunk(p.t0);case 37:case"end":return p.stop()}},null,this,[[4,26]])}function C(a){var c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:c=new(d("WAPromiseRetryLoop").PromiseRetryLoop)({name:"QplUploadChunk",timer:{algo:{type:r.type,first:r.minTimeout},max:r.maxTimeout},code:function(b){var c=a[0].id,e=a[a.length-1].id;d("WALogger").DEV(i(),c,e,a.length);return y.sendEvents(a).then(function(){b()})["catch"](function(a){if(a instanceof d("WAQplTypes").QplServerStatusCodeError)switch(a.statusCode){case 500:d("WALogger").WARN(h(),a.message);break;default:b();break}throw a})}});c.start();e.next=4;return b("regeneratorRuntime").awrap(c.promise());case 4:case"end":return e.stop()}},null,this)}g.start=a;g.forceQplUpload=c}),98);
__d("WAWebPsIdUpdateWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumPsIdAction"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({PsIdUpdate:[2862,{isFromWamsys:[4,a.TYPES.BOOLEAN],psIdAction:[2,d("WAWebWamEnumPsIdAction").PS_ID_ACTION],psIdKey:[1,a.TYPES.INTEGER],psIdRotationFrequence:[3,a.TYPES.INTEGER]},[1,1,1],"regular"]},{PsIdUpdate:[]});g.PsIdUpdateWamEvent=b}),98);
__d("WAWebWebWamForceFlushWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({WebWamForceFlush:[3264,{},[1,1,1],"regular"]},{WebWamForceFlush:[]});g.WebWamForceFlushWamEvent=a}),98);
__d("WAWebWamUtils",["WABase64","WABinary","WALogger","WAQplUploader","WAWebABProps","WAWebPsIdUpdateWamEvent","WAWebUserPrefsGeneral","WAWebWamCodegenUtils","WAWebWamConstants","WAWebWamEnumAppBuildType","WAWebWamEnumWebcEnvCode","WAWebWamGlobals","WAWebWebWamForceFlushWamEvent","err","gkx"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["dropping invalid wam buffer"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["WAM: commitWorkerWamEvent failed, "," is not defined"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["force flushed all qpl buffers"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["force flushed all wam buffers"]);k=function(){return a};return a}function a(){new(d("WAWebWebWamForceFlushWamEvent").WebWamForceFlushWamEvent)().commitAndWaitForFlush(!0)["finally"](function(){return d("WALogger").LOG(k()).tags("wam")}),d("WAQplUploader").forceQplUpload()["finally"](function(){return d("WALogger").LOG(j()).tags("qpl")})}function b(a,b,c){new(d("WAWebPsIdUpdateWamEvent").PsIdUpdateWamEvent)({psIdAction:a,psIdKey:b,psIdRotationFrequence:c}).commit()}function l(a,b){b=JSON.parse(b);var c=d("WAWebWamCodegenUtils").events[a];if(c==null){d("WALogger").ERROR(i(),a).sendLogs("wam-worker-event-undefined-error");return}new c(b).commit()}function m(a,b){var c;b=JSON.parse(b);b=b.value;d("WAWebWamGlobals").Global.set((c={},c[a]=b,c))}function e(a){var b=a.action,c=a.name;a=a.payload;return b==="commit"?l(c,a):m(c,a)}function f(a){var b=!0;try{var c=d("WAWebABProps").getABPropConfigValue("web_wam_data_loss_mitigation")?d("WAWebWamConstants").WAM_MAX_BUFFER_SIZE_FOR_UPLOAD:d("WAWebWamConstants").WAM_MAX_BUFFER_SIZE;a=new(d("WABinary").Binary)(d("WABase64").decodeB64(a));b=a.size()>c}catch(a){d("WALogger").ERROR(h())}return b}function n(a){return a==="regular"?"regular":"private"}function o(){if(c("gkx")("26258"))return d("WAWebWamEnumAppBuildType").APP_BUILD_TYPE.RELEASE;else if(c("gkx")("26259")||c("gkx")("26261"))return d("WAWebWamEnumAppBuildType").APP_BUILD_TYPE.BETA;return d("WAWebWamEnumAppBuildType").APP_BUILD_TYPE.ALPHA}function p(){if(c("gkx")("26259"))return d("WAWebWamEnumWebcEnvCode").WEBC_ENV_CODE.INTERN;else if(c("gkx")("26258"))return d("WAWebWamEnumWebcEnvCode").WEBC_ENV_CODE.PROD;else if(c("gkx")("26256"))return d("WAWebWamEnumWebcEnvCode").WEBC_ENV_CODE.E2E;throw c("err")("invalid env")}function q(){return d("WAWebUserPrefsGeneral").getWhatsAppWebExternalBetaJoinedIdb()}function r(a){if(c("gkx")("26256")){var b=window.__je2e_recordWAMEvent;(b||typeof b==="function")&&b(babelHelpers["extends"]({name:a.$className},a.all))}}function s(a,b){if(c("gkx")("26256")){var d=window.__je2e_recordWAMEvent;(d||typeof d==="function")&&d({name:a,value:b})}}function t(){return d("WAWebABProps").getABPropConfigValue("web_wam_data_loss_mitigation")?5:d("WAWebWamConstants").PENDING_DELAY_IN_SECONDS}g.forceFlushAllWamAndQplBuffers=a;g.logPsIdUpdate=b;g.processWorkerWamDataRow=e;g.isWamBufferTooBigToUpload=f;g.getChannelFromBufferKey=n;g.getAppBuild=o;g.getWamEnv=p;g.getAppIsBetaRelease=q;g.maybeForwardWamEventToJestE2e=r;g.maybeForwardWamAttributeToJestE2e=s;g.getInMemoryBufferingDurationInSecs=t}),98);
__d("WAWebWamStorage",["WALogger","WAWebWAWCStorage","WAWebWamConstants","WAWebWamUtils","asyncToGeneratorRuntime","err","gkx"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["processWorkerWamData failed: ","\n",""],["processWorkerWamData failed: ","\\n",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam: getNextSequenceNumberForStream failed"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["getNextSequenceNumberForStream failed: ","\n",""],["getNextSequenceNumberForStream failed: ","\\n",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["deleteAll failed: ","\n",""],["deleteAll failed: ","\\n",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["update failed: ","\n",""],["update failed: ","\\n",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["add failed: ","\n",""],["add failed: ","\\n",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["savePsToken failed: ","\n",""],["savePsToken failed: ","\\n",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["getPsToken failed: ","\n",""],["getPsToken failed: ","\\n",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["updatePsMeta failed: ","\n",""],["updatePsMeta failed: ","\\n",""]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["addPsMeta failed: ","\n",""],["addPsMeta failed: ","\\n",""]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["getPsMeta failed: ","\n",""],["getPsMeta failed: ","\\n",""]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["removePsMeta failed: ","\n",""],["removePsMeta failed: ","\\n",""]);s=function(){return a};return a}function a(a,b,c){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f=(yield c("WAWebWAWCStorage").idb());return f.wam.add({key:a,buffer:e,channel:b},a)["catch"](function(a){d("WALogger").LOG(m(),a,a==null?void 0:a.stack)})});return t.apply(this,arguments)}function e(a,b,c){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f=0;try{f=(yield c("WAWebWAWCStorage").idb().then(function(c){return c.wam.update(a,{key:a,buffer:e,channel:b})}))}catch(a){d("WALogger").LOG(l(),a,a==null?void 0:a.stack)}return f!==0});return u.apply(this,arguments)}function f(a){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b={};try{yield c("WAWebWAWCStorage").idb().then(function(c){return c.wam.where("channel").equals(a).modify(function(a,c){b[a.key]=a.buffer,delete c.value})})}catch(a){d("WALogger").LOG(k(),a,a==null?void 0:a.stack)}return b});return v.apply(this,arguments)}function w(a){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=-1,f=1<<16;try{var g=(yield c("WAWebWAWCStorage").idb());yield g.transaction("rw",["wam_meta"],b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=(yield g.wam_meta.where("streamId").equals(a).count());b===0?(yield g.wam_meta.add({streamId:a,seqNum:1}),e=1):yield g.wam_meta.where("streamId").equals(a).modify(function(a){e=a.seqNum+1;e>=f&&(e=1);a.seqNum=e;return a})}))}catch(a){d("WALogger").LOG(j(),a,a==null?void 0:a.stack)}if(e===-1){c("gkx")("26258")||d("WALogger").ERROR(i()).sendLogs("getNextSequenceNumberForStreamFailed");throw c("err")("could not get seq number for streamId "+a)}return e});return x.apply(this,arguments)}function y(a){return c("WAWebWAWCStorage").idb().then(function(b){return b.ps_meta.bulkDelete(a)})["catch"](function(a){d("WALogger").LOG(s(),a,a==null?void 0:a.stack)})}function z(){return c("WAWebWAWCStorage").idb().then(function(a){return a.ps_meta.toArray()})["catch"](function(a){d("WALogger").LOG(r(),a,a==null?void 0:a.stack);return[]})}function A(a){return c("WAWebWAWCStorage").idb().then(function(b){return b.ps_meta.bulkPut(a)})["catch"](function(a){d("WALogger").LOG(q(),a,a==null?void 0:a.stack)})}function B(a){return c("WAWebWAWCStorage").idb().then(function(b){return b.ps_meta.update(a.key,a)})["catch"](function(a){d("WALogger").LOG(p(),a,a==null?void 0:a.stack)})}function C(){return c("WAWebWAWCStorage").idb().then(function(a){return a.ps_tokens.get("token")})["catch"](function(a){d("WALogger").LOG(o(),a,a==null?void 0:a.stack)})}function D(a){return c("WAWebWAWCStorage").idb().then(function(b){return b.transaction("rw",["ps_tokens"],function(){return b.ps_tokens.put(a)})})["catch"](function(a){d("WALogger").LOG(n(),a,a==null?void 0:a.stack)})}function E(a,b){return F.apply(this,arguments)}function F(){F=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var d=(yield c("WAWebWAWCStorage").idb());return d.transaction("rw",["core_wam","core_wam_meta"],function(){return d.core_wam.put(b).then(function(){return d.core_wam_meta.put(a)})})});return F.apply(this,arguments)}function G(a){return H.apply(this,arguments)}function H(){H=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield c("WAWebWAWCStorage").idb());return b.core_wam.where("streamId").equals(a).modify({finished:!0})});return H.apply(this,arguments)}function I(a){return J.apply(this,arguments)}function J(){J=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield c("WAWebWAWCStorage").idb());return b.core_wam_meta.get({streamId:a})});return J.apply(this,arguments)}function K(){return L.apply(this,arguments)}function L(){L=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield c("WAWebWAWCStorage").idb());return a.core_wam.toArray()});return L.apply(this,arguments)}function M(){return N.apply(this,arguments)}function N(){N=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield c("WAWebWAWCStorage").idb());return a.transaction("rw",["core_wam","core_wam_meta"],function(){return a.core_wam.clear().then(function(){return a.core_wam_meta.clear()})})});return N.apply(this,arguments)}function O(a){return P.apply(this,arguments)}function P(){P=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield c("WAWebWAWCStorage").idb());return b.core_wam["delete"](a)});return P.apply(this,arguments)}function Q(a){return R.apply(this,arguments)}function R(){R=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield c("WAWebWAWCStorage").idb());return b.transaction("rw",["worker_wam_events"],function(){return b.worker_wam_events.put(a)})});return R.apply(this,arguments)}function S(){return T.apply(this,arguments)}function T(){T=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield c("WAWebWAWCStorage").idb());try{yield a.transaction("rw",["worker_wam_events"],b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield a.worker_wam_events.limit(d("WAWebWamConstants").WAM_WORKER_DATA_BATCH_SIZE).modify(function(a,b){d("WAWebWamUtils").processWorkerWamDataRow(a),delete b.value})}));var e=(yield a.worker_wam_events.count());return e>0}catch(a){d("WALogger").LOG(h(),a,a==null?void 0:a.stack);return!1}});return T.apply(this,arguments)}a={add:a,update:e,deleteAll:f,getNextSequenceNumberForStream:w,addCoreWamBuffer:E,finishAllCoreWamBuffers:G,getCoreWamStartingSequenceNumber:I,getAllCoreWamBuffers:K,nukeAllCoreWamBuffers:M,removeWamBufferByKey:O,storeWorkerWamData:Q,processWorkerWamData:S,removePsMeta:y,getPsMeta:z,addPsMeta:A,updatePsMeta:B,getPsToken:C,savePsToken:D};e=a;g["default"]=e}),98);
__d("WAWebWamPrivateStats",["Promise","WAHex","WALogger","WAResolvable","WATimeUtils","WAWebWamEnumPsIdAction","WAWebWamGlobals","WAWebWamStorage","WAWebWamUtils","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["error while rotating PS ids ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["error while rotating PS id for key ",""]);j=function(){return a};return a}var k={},l={},m={};d("WAWebWamGlobals").PrivateStatsAllIds.map(function(a){k[a.keyHashInt]=a.key,l[a.key]=a.keyHashInt,m[a.key]={value:a.keyHashInt,rotationPeriodDays:a.rotationPeriodDays}});k[0]="none";l.none=0;m.none={value:"none",rotationPeriodDays:-1};var n=null;function a(){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(n!=null)return n.promise;var a=new(d("WAResolvable").Resolvable)();n=a;var b=[],e=(yield c("WAWebWamStorage").getPsMeta()),f=new Set();e.map(function(a){f.add(a.key),m[a.key]===void 0?b.push(a.key):m[a.key].value=a.value});e=Object.keys(m).filter(function(a){return!f.has(a)}).map(function(a){a!=="none"&&(m[a].value=d("WAHex").randomHex(16));return{key:a,value:m[a].value,rotateInDays:m[a].rotationPeriodDays,creationTs:d("WATimeUtils").unixTime()}});yield c("WAWebWamStorage").addPsMeta(e);yield c("WAWebWamStorage").removePsMeta(b);e.map(function(a){return d("WAWebWamUtils").logPsIdUpdate(d("WAWebWamEnumPsIdAction").PS_ID_ACTION.CREATED,l[a.key],a.rotateInDays)});b.map(function(a){return d("WAWebWamUtils").logPsIdUpdate(d("WAWebWamEnumPsIdAction").PS_ID_ACTION.DELETED,l[a],m[a].rotationPeriodDays)});a.resolve()});return o.apply(this,arguments)}function e(){var a=new Map();d("WAWebWamGlobals").PrivateStatsAllIds.forEach(function(b){a.set(b.keyHashInt,String(m[b.key].value))});return a}function f(a){if(n==null)throw c("err")("can't call getPrivateStatsKeyFromInt without initializing");return k[a]}function p(a){if(a==="regular")throw c("err")("tried to get psId for regular channel event");if(n==null)throw c("err")("can't call getLatestPrivateStatsIdValueFromKey without initializing");return m[a].value}function q(){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=[];if(n==null)throw c("err")("can't call maybeRotatePsIds without initializing");try{yield n.promise;var e=(yield c("WAWebWamStorage").getPsMeta());yield (h||(h=b("Promise"))).all(e.map(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){try{var c=b.key,e=b.rotateInDays,f=b.creationTs;u(f,e)&&(a.push(c),yield s(c))}catch(a){d("WALogger").WARN(j(),b.key)}});return function(a){return c.apply(this,arguments)}}()))}catch(a){d("WALogger").WARN(i(),a)}return a});return r.apply(this,arguments)}function s(a){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAHex").randomHex(16);m[a].value=b;yield c("WAWebWamStorage").updatePsMeta({key:a,rotateInDays:m[a].rotationPeriodDays,value:b,creationTs:d("WATimeUtils").unixTime()});d("WAWebWamUtils").logPsIdUpdate(d("WAWebWamEnumPsIdAction").PS_ID_ACTION.ROTATED,l[a],m[a].rotationPeriodDays)});return t.apply(this,arguments)}function u(a,b){if(b===-1||a==null)return!1;b=b*d("WATimeUtils").DAY_SECONDS;b=Math.floor(d("WATimeUtils").unixTime()/b)*b;return a<b}g.initPrivateStats=a;g.getPrivateStatsIdsForCoreWam=e;g.getPrivateStatsKeyFromInt=f;g.getLatestPrivateStatsIdValueFromKey=p;g.maybeRotatePsIds=q}),98);
__d("WAWebWamInterop",["Promise","WACustomError","WATimeUtils","WAWamStorage","WAWebUserPrefsGeneral","WAWebWamPrivateStats","WAWebWamStorage","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=function(a,c){return(h||(h=b("Promise"))).reject(new(d("WACustomError").UnimplementedMethod)("saveBuffer not implemented yet"))},j=function(a){return(h||(h=b("Promise"))).resolve()},k=function(a){return(h||(h=b("Promise"))).reject(new(d("WACustomError").UnimplementedMethod)("getStartingSequenceRow not implemented yet"))},l=function(){return(h||(h=b("Promise"))).reject(new(d("WACustomError").UnimplementedMethod)("getBuffers not implemented yet"))},m=function(){return(h||(h=b("Promise"))).reject(new(d("WACustomError").UnimplementedMethod)("nukeMetrics not implemented yet"))},n=function(a){return(h||(h=b("Promise"))).reject(new(d("WACustomError").UnimplementedMethod)("finishBuffer not implemented yet"))},o=function(){return(h||(h=b("Promise"))).reject(new(d("WACustomError").UnimplementedMethod)("updatePrivateStatsIds not implemented yet"))},p=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var d=(yield c("WAWebWamStorage").getPsToken());if(!d)return null;return!a({redeemCount:d.redeemCount,creationTs:d.creationTs},{maxExpirySeconds:86400})?(h||(h=b("Promise"))).resolve(null):c("WAWebWamStorage").savePsToken(babelHelpers["extends"]({},d,{redeemCount:d.redeemCount+1})).then(function(){return d.token})});return function(b){return a.apply(this,arguments)}}();function a(a){return c("WAWebWamStorage").savePsToken({key:"token",token:a,creationTs:d("WATimeUtils").unixTime(),redeemCount:1})}function e(){return(h||(h=b("Promise"))).resolve(d("WAWebUserPrefsGeneral").getPsKillSwitchToken())}function f(a){d("WAWebUserPrefsGeneral").setPsKillSwitchToken(a);return(h||(h=b("Promise"))).resolve()}var q={getStreamId:function(){return 1},saveBuffer:i,finishBuffer:n,getStartingSequenceRow:k,getBuffers:l,removeBufferByKey:j,nukeMetrics:m,updatePrivateStatsIds:o,redeemPrivateStatsToken:p,savePrivateStatsToken:a,privateStatsKillSwitchGetBlockedToken:e,privateStatsKillSwitchSet:f};function r(){d("WAWamStorage").startWamStorage(q)}function s(){d("WAWamStorage").closeWamStorage()}g.startWamStore=r;g.closeWamStore=s}),98);
__d("WAWebWamBeaconing",["WATimeUtils","WAWebUserPrefsGeneral"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=d("WAWebUserPrefsGeneral").getWamBeaconingSettings(),c=b.find(function(b){return b.key===a}),e=null;if(c==null||h(c.ts)){var f=d("WATimeUtils").unixTime(),g=Math.random()<=.01;g={key:a,ts:f,value:g?1:null};c==null?b.push(g):(c.value=g.value,c.ts=f);e=g.value}else if(c.value==null)return null;else e=++c.value;d("WAWebUserPrefsGeneral").setWamBeaconingSettings(b);return e}function h(a){var b=Math.floor(d("WATimeUtils").unixTime()/d("WATimeUtils").DAY_SECONDS);a=Math.floor(a/d("WATimeUtils").DAY_SECONDS);return b!==a}g.maybeGetEventSequenceNumber=a}),98);
__d("WAWebWamLibProtocol",["WABinary"],(function(a,b,c,d,e,f,g){var h=8,i=0,j=1,k=2,l=4;function a(a,b,c){return m(a,b,c,i)}function b(a,b,c,d){d=d?j:j|l;return m(a,b,c,d)}function c(a,b,c,d){d=d?k:k|l;return m(a,b,c,d)}function m(a,b,c,e){if(c==null)e===i&&n(a,b,e);else if(typeof c==="number"&&c===(c|0))c===0?n(a,b,e|1<<4):c===1?n(a,b,e|2<<4):-128<=c&&c<128?(n(a,b,e|3<<4),a.writeInt8(c)):-32768<=c&&c<32768?(n(a,b,e|4<<4),a.writeInt16(c)):(n(a,b,e|5<<4),a.writeInt32(c));else if(typeof c==="number")n(a,b,e|7<<4),a.writeFloat64(c);else if(typeof c==="string"){var f=d("WABinary").numUtf8Bytes(c);f<256?(n(a,b,e|8<<4),a.writeUint8(f)):f<65536?(n(a,b,e|9<<4),a.writeUint16(f)):(n(a,b,e|10<<4),a.writeUint32(f));a.writeString(c)}}function n(a,b,c){b<256?(a.writeUint8(c),a.writeUint8(b)):(a.writeUint8(c|h),a.writeUint16(b))}g.writeGlobalAttribute=a;g.writeEvent=b;g.writeField=c}),98);
__d("WAWebWamLibContext",["WABase64","WABinary","WALogger","WAWebEventSampling","WAWebWamBeaconing","WAWebWamCodegenUtils","WAWebWamConstants","WAWebWamLibProtocol","WAWebWamPrivateStats"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam: invalid value for timer field ",".",""]);h=function(){return a};return a}var i=47,j=3433,k=6005,l=0,m=2,n=2147483647;a=function(){function a(a,b,c){this.bufferKey=a,this.buffer=new(d("WABinary").Binary)(void 0,!0),this.buffer.writeString("WAM"),this.buffer.writeUint8(d("WAWebWamConstants").WAM_PROTOCOL_VERSION),this.buffer.writeUint8(1),this.buffer.writeUint16(b),this.bufferKey==="regular"?this.buffer.writeUint8(l):this.buffer.writeUint8(m),this.eventsWritten=0,this.prevGlobals={},this.dirtyGlobals={},this.unsavedPortion=null,this.saveKey=String(Math.random()*1e9|0),this.$1(c)}var b=a.prototype;b.size=function(){return this.buffer.size()};b.set=function(a,b){this.dirtyGlobals[String(a)]=b,this.unsavedPortion&&this.unsavedPortion.set(a,b)};b.write=function(a){var b=this.buffer;this.set(i,a.commitTime);var c=d("WAWebWamBeaconing").maybeGetEventSequenceNumber(this.bufferKey);c!=null&&this.set(j,c);a.wamChannel==="private"&&this.set(k,d("WAWebWamPrivateStats").getLatestPrivateStatsIdValueFromKey(this.bufferKey).toString());this.$2();c=a.all;var e=Object.keys(c),f=-1,g=!1;for(var l=0;l<e.length;l++){var m=c[e[l]];m!=null&&(f=l,g=!0)}l=(m=d("WAWebEventSampling").getClientEventSamplingWeight(a.id))!=null?m:a.weight;d("WAWebWamLibProtocol").writeEvent(b,a.id,-l,g);for(m=0;m<=f;m++){l=e[m];var o=d("WAWebWamCodegenUtils").metrics.getEvent(a.$className,l),p=o.id;o=o.type;var q=c[l];if(q==null)continue;typeof q==="boolean"&&(q=q?1:0);g=m<f;if(o==="timer"&&q>n){d("WALogger").ERROR(h(),a.$className,l).sendLogs("wam-event-validation-error");continue}d("WAWebWamLibProtocol").writeField(b,p,q,g)}this.eventsWritten++;this.unsavedPortion&&this.unsavedPortion.write(a)};b.stringBuffer=function(){return this.eventsWritten>0?d("WABase64").encodeB64(this.buffer.peek(function(a){return a.readByteArray()})):""};b.getBuffer=function(){return this.buffer};b.$1=function(a){var b=this.bufferKey==="regular"?"regular":"private";for(var c in a){var e=a[c],f=d("WAWebWamCodegenUtils").metrics.getGlobal(c);f=f.channels.includes(b);e!==void 0&&f&&this.set(d("WAWebWamCodegenUtils").metrics.getGlobal(c).id,e)}};b.$2=function(){var a=this.dirtyGlobals,b=this.prevGlobals;for(var c in a){var e=a[c];if(typeof e==="boolean")e=e?1:0;else if(e===void 0)e=null;else if(Number.isNaN(e))continue;if(e!==b[c]||c===String(i)||c===String(k)){b[c]=e;var f=parseInt(c,10);d("WAWebWamLibProtocol").writeGlobalAttribute(this.buffer,f,e)}}this.dirtyGlobals={}};return a}();g.WamContext=a}),98);
__d("WAWebWamPlatform",["WAWebPwaDocumentMetadataUtils","gkx"],(function(a,b,c,d,e,f,g){var h="WEB";c("gkx")("26265")&&(c("gkx")("26261")?h="DARWIN_BETA":c("gkx")("26267")||c("gkx")("26266")?h="MACSTORE":h="DARWIN");function a(){return c("gkx")("26264")&&d("WAWebPwaDocumentMetadataUtils").isCurrentWebSessionInsidePwa()?"PWA":h}g.getWamPlatform=a}),98);
__d("WAWebWam",["Promise","WALogger","WANullthrows","WAResolvable","WAShiftTimer","WATimeUtils","WAWebBuildConstants","WAWebCrashlog","WAWebEventSampling","WAWebIsOfficialClient","WAWebMiscBrowserUtils","WAWebUploadPrivateStatsBackend","WAWebUploadStatsBackend","WAWebUserPrefsIsLoggedIn","WAWebUserPrefsTabMutex","WAWebWamClientErrorsWamEvent","WAWebWamConstants","WAWebWamEnumDeviceClassification","WAWebWamEnumPlatformType","WAWebWamEnumWebcWebPlatformType","WAWebWamFingerprintReporter","WAWebWamGlobals","WAWebWamInterop","WAWebWamLibContext","WAWebWamPlatform","WAWebWamPrivateStats","WAWebWamRuntimeProvider","WAWebWamStorage","WAWebWamUtils","asyncToGeneratorRuntime","lodash"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam dropped "," buffers! ("," bytes)"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendAllLogs: process failures success bufferKey ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendAllLogs: adding to WamStorage failed"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendAllLogs: process failures start bufferKey ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendAllLogs: sendLogs success"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendAllLogs: sendLogs start"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam:sendAllLogs failed to read because ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam:save WamStorage failed to save ",""]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam:save successfully saved new entry ",""]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam:saveCurrentContext no unsavedPortion WamStorage.update end"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam:saveCurrentContext no unsavedPortion WamStorage.update start"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam:save other tab claimed buffer, cutting head"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam:save successfully updated ",""]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam:saveCurrentContext has unsavedPortion WamStorage.update end"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam:saveCurrentContext has unsavedPortion WamStorage.update start"]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam:_executePending error ",""]);x=function(){return a};return a}function y(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam:_executePending abandoned current buffer"]);y=function(){return a};return a}function z(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam:_executePending wam unauthed, didn't send"]);z=function(){return a};return a}function A(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam:_executePendingForContext failed to get context ",""]);A=function(){return a};return a}function B(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam:executePending "," jobs"]);B=function(){return a};return a}function C(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam:initialize"]);C=function(){return a};return a}function D(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendLogs: uploadStats"]);D=function(){return a};return a}function E(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendLogs: uploadPrivateStats"]);E=function(){return a};return a}function F(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam enable processing"]);F=function(){return a};return a}function G(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam pause processing"]);G=function(){return a};return a}function H(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam:set "," = ",""]);H=function(){return a};return a}function aa(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam:commit ",""]);aa=function(){return a};return a}function ba(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam:commit redundant commit! ",""]);ba=function(){return a};return a}function ca(){var a=babelHelpers.taggedTemplateLiteralLoose(["wam:this tab is in the background, skipping WAM processing for now"]);ca=function(){return a};return a}var I,da=[],J=[],ea=!1,fa="1",ga=c("lodash").mapValues({commit:f,set:ka,resumeJobs:oa,initialize:la},e);function a(){da=d("WAWebWamGlobals").PrivateStatsAllIds.map(function(a){return a.key});d("WAWebWamPrivateStats").initPrivateStats();d("WAWebWamInterop").startWamStore();d("WAWebWamFingerprintReporter").logFingerprintToWam();I=new(d("WAShiftTimer").ShiftTimer)(function(){if(!d("WAWebUserPrefsTabMutex").currentTabHasMutex()){d("WALogger").WARN(ca());return}pa()});d("WAWebWamRuntimeProvider").setWamRuntime(ga);while(J.length){var a=J.pop();a()}ea=!0}function e(a){return function(){for(var b=arguments.length,c=new Array(b),d=0;d<b;d++)c[d]=arguments[d];if(ea)return a.apply(void 0,c);J.push(function(){a.apply(void 0,c)})}}var K={},ha=0,L=[],M=!1,ia=!1,N=null,O=new(d("WAResolvable").Resolvable)(),P=!1,Q=!1;function f(a,c){var e;c===void 0&&(c=!1);if(a.commitTime!=null&&a.commitTime!==0){d("WALogger").WARN(ba(),a.$className);return(h||(h=b("Promise"))).resolve()}e=(e=d("WAWebEventSampling").getClientEventSamplingWeight(a.id))!=null?e:a.weight;if(e!==0&&Math.random()*e>1){a.commitTime=d("WATimeUtils").unixTimeWithoutClockSkewCorrection();return(h||(h=b("Promise"))).resolve()}d("WALogger").DEV(aa(),a.$className).devConsole(a.all);ja(a);d("WAWebWamUtils").maybeForwardWamEventToJestE2e(a);return ma(a,c)}function ja(a,b){a.commitTime=b!=null?b:d("WATimeUtils").unixTimeWithoutClockSkewCorrection()}function ka(a,b){d("WALogger").DEV(H(),a.name,String(b));d("WAWebWamUtils").maybeForwardWamAttributeToJestE2e(a.name,String(b));return ma([a,b])}function la(a){return R.apply(this,arguments)}function R(){R=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(N&&!a)return(h||(h=b("Promise"))).resolve(N);var e=c("WAWebMiscBrowserUtils").info(),f={appVersion:d("WAWebBuildConstants").VERSION_BASE,appBuild:d("WAWebWamUtils").getAppBuild(),platform:d("WAWebWamEnumPlatformType").PLATFORM_TYPE.WEBCLIENT,appIsBetaRelease:yield d("WAWebWamUtils").getAppIsBetaRelease(),browser:e.name||null,browserVersion:e.ua||null,deviceName:e.os||null,deviceVersion:e.version||null,webcEnv:d("WAWebWamUtils").getWamEnv(),webcTabId:d("WAWebUserPrefsTabMutex").THIS_TAB,webcWebPlatform:d("WAWebWamEnumWebcWebPlatformType").WEBC_WEB_PLATFORM_TYPE[d("WAWebWamPlatform").getWamPlatform()],ocVersion:d("WAWebIsOfficialClient").isOfficialClient?1:0,deviceClassification:d("WAWebWamEnumDeviceClassification").DEVICE_CLASSIFICATION.DESKTOP,webcRevision:d("WAWebBuildConstants").REVISION};N=f;a&&Object.assign(N,a);d("WALogger").DEV(C()).devConsole(N);d("WAWebWamGlobals").Global.commitOnSet=!1;d("WAWebWamGlobals").Global.set(N);d("WAWebWamGlobals").Global.commitOnSet=!0;Object.keys(f).forEach(function(a){return d("WAWebWamUtils").maybeForwardWamAttributeToJestE2e(a,String(f[a]))});return f});return R.apply(this,arguments)}function ma(a,b){b===void 0&&(b=!1);L.push(a);M?b?(P=!1,Q=!0,self.setTimeout(function(){return I.forceRunNow()},1)):I.onOrBefore(d("WAWebWamUtils").getInMemoryBufferingDurationInSecs()*1e3):b&&(I.cancel(),P=!0,Q=!1);return O.promise}function na(){d("WALogger").DEV(G());M=!1;I.cancel();var a=O;O=new(d("WAResolvable").Resolvable)();return a}function oa(){d("WALogger").DEV(F()),M=!0,Q=!1,L.length>0&&I.onOrBefore(d("WAWebWamUtils").getInMemoryBufferingDurationInSecs()*1e3),P&&(P=!1,Q=!0,I.forceRunNow())}function pa(){return S.apply(this,arguments)}function S(){S=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=Q,c=na(),e=[].concat(L);L=[];try{var f=(yield la()),g=(yield d("WAWebWamPrivateStats").maybeRotatePsIds());yield (h||(h=b("Promise"))).all(g.map(function(a){return qa(a,f)}));d("WALogger").DEV(B(),e.length);yield h.all(["regular","none"].concat(da).map(function(b){return sa(b,e,a,f)}))}finally{c.resolve(),oa()}});return S.apply(this,arguments)}function qa(a,b){return T.apply(this,arguments)}function T(){T=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){yield Y(a,b);K[a]=(yield U(a,b));return K[a]});return T.apply(this,arguments)}function U(a,b){return V.apply(this,arguments)}function V(){V=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return new(d("WAWebWamLibContext").WamContext)(a,yield c("WAWebWamStorage").getNextSequenceNumberForStream(fa),b)});return V.apply(this,arguments)}function ra(a,b){return W.apply(this,arguments)}function W(){W=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c;c=(c=K[a])!=null?c:yield U(a,b);K[a]=c;return c});return W.apply(this,arguments)}function sa(a,b,c,d){return X.apply(this,arguments)}function X(){X=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){var f=d("WAWebWamUtils").getChannelFromBufferKey(a),g;try{g=(yield ra(a,e))}catch(a){d("WALogger").WARN(A(),String((a==null?void 0:a.stack)?a.stack:a));return}try{for(var h=0;h<b.length;h++){if(g.size()>d("WAWebWamConstants").WAM_MAX_BUFFER_SIZE){var i=(yield qa(a,e));if(i==null)break;g=i}i=b[h];if(!Array.isArray(i)){var j=i;(j.wamChannel==="regular"&&j.wamChannel===f||j.wamChannel==="private"&&a===d("WAWebWamPrivateStats").getPrivateStatsKeyFromInt(j.privateStatsIdInt))&&g.write(j)}else{j=i[0];i=i[1];j.channels.includes(f)&&(e[j.name]=i,g.set(j.id,i))}}j=d("WATimeUtils").unixTimeWithoutClockSkewCorrection();if(g.eventsWritten>0&&(c||g.size()>d("WAWebWamConstants").WAM_MAX_BUFFER_SIZE||j>=ha+d("WAWebWamConstants").WAM_ROTATE_INTERVAL_IN_SECONDS||!ia)){i=d("WAWebUserPrefsIsLoggedIn").isLoggedIn();if(!i){d("WALogger").DEV(z());g.buffer.size()>d("WAWebWamConstants").WAM_MAX_BUFFER_SIZE?(K[a]=null,d("WALogger").DEV(y())):yield Y(a,e);return}yield ta(a)}else yield Y(a,e)}catch(b){d("WALogger").WARN(x(),String((b==null?void 0:b.stack)?b.stack:b)).devConsole(b),void d("WAWebCrashlog").upload({reason:"wam-error"}),new(d("WAWebWamClientErrorsWamEvent").WamClientErrorsWamEvent)({wamClientBufferDropErrorCount:1}).commit(),K[a]=null}});return X.apply(this,arguments)}function Y(a,b){return Z.apply(this,arguments)}function Z(){Z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(!K[a])return;var e=K[a].stringBuffer();if(!e)return;var f=c("WANullthrows")(K[a]).unsavedPortion;if(f&&f.eventsWritten===0)return;var g=c("WANullthrows")(K[a]).saveKey;try{if(f){d("WALogger").DEV(w());f=(yield c("WAWebWamStorage").update(g,a,e));d("WALogger").DEV(v());if(!K[a])return;if(f)d("WALogger").DEV(u(),g),c("WANullthrows")(K[a]).unsavedPortion=(yield U(a,b));else{K[a]=K[a].unsavedPortion;d("WALogger").DEV(t());yield Y(a,b);return}}else{d("WALogger").DEV(s());yield c("WAWebWamStorage").add(g,a,e);d("WALogger").DEV(r());if(!K[a])return;d("WALogger").DEV(q(),g);c("WANullthrows")(K[a]).unsavedPortion=(yield U(a,b))}}catch(a){d("WALogger").WARN(p(),String(a)).devConsole(a)}});return Z.apply(this,arguments)}function ta(a){return $.apply(this,arguments)}function $(){$=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e;try{e=(yield c("WAWebWamStorage").deleteAll(a))}catch(a){e={},d("WALogger").WARN(o(),String(a)).devConsole(a)}var f=e;if(K[a]){K[a].unsavedPortion&&!(K[a].saveKey in f)&&(K[a]=K[a].unsavedPortion);e=c("WANullthrows")(K[a]).saveKey;f[e]=c("WANullthrows")(K[a]).stringBuffer()}d("WALogger").DEV(n());e=(yield (h||(h=b("Promise"))).all(c("lodash").map(f,function(b,c){return ua(b,c,d("WAWebWamUtils").getChannelFromBufferKey(a))})));d("WALogger").DEV(m());var g=e.filter(Boolean);g.length!==e.length&&(ha=d("WATimeUtils").unixTimeWithoutClockSkewCorrection(),ia=!0);K[a]&&!g.includes(K[a].saveKey)&&(K[a]=null);if(g.length===0)return;e=g.reduce(function(a,b){return a+f[b].length},0);e<d("WAWebWamConstants").WAM_MAX_BUFFER_SIZE?(d("WALogger").DEV(l(),a),yield (h||(h=b("Promise"))).all(c("lodash").map(g,function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){try{yield c("WAWebWamStorage").add(b,a,f[b])}catch(a){d("WALogger").WARN(k())}});return function(a){return e.apply(this,arguments)}}())),d("WALogger").DEV(j(),a)):(K[a]=null,new(d("WAWebWamClientErrorsWamEvent").WamClientErrorsWamEvent)({wamClientBufferDropErrorCount:1}).commit(),d("WALogger").WARN(i(),g.length,e).devConsole(f))});return $.apply(this,arguments)}function ua(a,e,f){if(a==="")return(h||(h=b("Promise"))).resolve();if(a[0]==="[")return(h||(h=b("Promise"))).resolve();if(d("WAWebWamUtils").isWamBufferTooBigToUpload(a)){new(d("WAWebWamClientErrorsWamEvent").WamClientErrorsWamEvent)({wamClientBufferDropErrorCount:1}).commit();return(h||(h=b("Promise"))).resolve()}if(f==="private"){d("WALogger").DEV(E());return c("WAWebUploadPrivateStatsBackend")(a,e)}if(f==="regular"){d("WALogger").DEV(D());return c("WAWebUploadStatsBackend")(a,e)}return(h||(h=b("Promise"))).resolve()}g.Wam=ga;g.initWamRuntime=a;g.sendAllLogs=ta}),98);
__d("WAWebBotMessageSecret",["WABinary","WACryptoAesGcm","WACryptoHkdf","WANullthrows","WAWebDBMessageSerialization","WAWebMsgKey","WAWebMsmsgMsgSecretCache","WAWebProtobufsE2E.pb","WAWebSchemaMessage","WAWebUserPrefsMeUser","WAWebWidToJid","asyncToGeneratorRuntime","decodeProtobuf"],(function(a,b,c,d,e,f,g){var h=32,i="Bot Message";function j(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=new(d("WABinary").Binary)(a).readByteArray();a=(yield d("WACryptoHkdf").extractAndExpand(new Uint8Array(a),i,h));return a});return k.apply(this,arguments)}function a(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsE2E.pb").MessageSecretMessageSpec,a);var e=a.encIv;a=a.encPayload;var f=d("WAWebUserPrefsMeUser").assertGetMeUser();f=b.msgMeta.targetSenderJid?b.msgMeta.targetSenderJid.isSameAccount(f):!0;var g=b.msgMeta.targetChatJid?c("WANullthrows")(b.msgMeta.targetChatJid):b.msgInfo.chat;f={fromMe:f,remote:g,id:c("WANullthrows")(b.msgMeta.targetId)};b.msgInfo.chat.isGroup()&&(f.participant=b.msgMeta.targetSenderJid);g=new(c("WAWebMsgKey"))(f);f=d("WAWebMsmsgMsgSecretCache").msmsgMsgSecretCache.getMsmsgMsgSecretFromCache(g.toString());if(f==null){g=(yield d("WAWebSchemaMessage").getMessageTable().get(g.toString()));f=d("WAWebDBMessageSerialization").messageFromDbRow(c("WANullthrows")(g)).messageSecret}g=(yield j(c("WANullthrows")(f)));f=b.msgInfo.externalId;var h=b.msgMeta.targetSenderJid?d("WAWebWidToJid").widToUserJid(b.msgMeta.targetSenderJid):d("WAWebWidToJid").widToUserJid(d("WAWebUserPrefsMeUser").assertGetMeUser()),i=d("WAWebWidToJid").widToUserJid(c("WANullthrows")(b.msgInfo.author));try{var k=(yield m(f,h,i,g));k=(yield d("WACryptoAesGcm").gcmDecrypt(k,c("WANullthrows")(e),c("WANullthrows")(a),f+"\0"+i))}catch(j){f=c("WANullthrows")((b=b.msgBotInfo)==null?void 0:b.botEditTargetId);b=(yield m(f,h,i,g));k=(yield d("WACryptoAesGcm").gcmDecrypt(b,c("WANullthrows")(e),c("WANullthrows")(a),f+"\0"+i))}return k});return l.apply(this,arguments)}function m(a,b,c,d){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f){a=d("WABinary").Binary.build(a,b,e).readBuffer();b=(yield d("WACryptoHkdf").extractAndExpand(new Uint8Array(c("WANullthrows")(f)),a,h));return b});return n.apply(this,arguments)}g.genBotMsgSecretFromMsgSecret=j;g.decryptMsmsgBotMessage=a}),98);
__d("WAWebCRUDOperationsNewsletterMyVotes",["Promise","WALogger","WAWebModelStorageUtils","WAWebNewsletterDBUtils","WAWebSchemaNewsletterMyVotes","WAWebWid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[createOrUpdateMyVote] Invalid newsletter jid ",""]);i=function(){return a};return a}function j(a){return d("WAWebModelStorageUtils").getStorage().lock(["newsletter-my-votes"],function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];if(!c("WAWebWid").isNewsletter(a.chatJid)){d("WALogger").WARN(i(),a.chatJid);return}b;var e=(yield l(a.chatJid,a.msgServerId));if(e!=null&&e.serverTimestampMs>a.serverTimestampMs)return;yield b.createOrReplace(a)});return function(a){return e.apply(this,arguments)}}())}function a(a){return d("WAWebModelStorageUtils").getStorage().lock(["newsletter-my-votes"],function(){var d=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];b;var d=new Map(),e=a.map(function(a){if(!c("WAWebWid").isNewsletter(a.chatJid))return;d.set(a.chatJid+"-"+a.msgServerId,a);return[a.chatJid,a.msgServerId]}).filter(Boolean);e=(yield b.anyOf(["chatJid","msgServerId"],e));e.forEach(function(a){var b=a.chatJid+"-"+a.msgServerId,c=d.get(b);c!=null&&c.serverTimestampMs<a.serverTimestampMs&&d["delete"](b)});yield b.bulkCreateOrReplace(Array.from(d.values()))});return function(a){return d.apply(this,arguments)}}())}function e(a,b){return d("WAWebSchemaNewsletterMyVotes").getTable().remove([a,b])}var k=100;function l(a,c){return!Number.isSafeInteger(c)||c<k||c>=d("WAWebNewsletterDBUtils").TEMPORARY_SERVER_ID_LOWER_BOUND?(h||(h=b("Promise"))).resolve(null):d("WAWebSchemaNewsletterMyVotes").getTable().get([a,c])}function f(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield l(a.chatJid,a.msgServerId));if(b==null)return;yield j(babelHelpers["extends"]({},b,a))});return m.apply(this,arguments)}g.createOrUpdateMyVote=j;g.bulkCreateOrUpdateMyVotes=a;g.deleteMyVote=e;g.getMyVote=l;g.updateMyVote=f}),98);
__d("WAWebNewsletterMsgEditUtils",["WAWebMsgKey","WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){return babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.Protocol,subtype:"message_edit",protocolMessageKey:a.id,latestEditMsgKey:a.id,latestEditSenderTimestampMs:a.t})}function b(a,b){var e=a.id.clone(),f=new(c("WAWebMsgKey"))({remote:a.id.remote,fromMe:a.id.fromMe,id:c("WAWebMsgKey").newId_DEPRECATED()});return babelHelpers["extends"]({},a,{id:f,type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.Protocol,subtype:"message_edit",editMsgType:a.type,protocolMessageKey:e,latestEditMsgKey:f,latestEditSenderTimestampMs:b.latestEditSenderTimestampMs})}g.mapMsgToEditProtocolMsgLegacy=a;g.mapMsgToEditProtocolMsg=b}),98);
__d("WAWebNewsletterMsgStanzaAdapters",["WAAckLevel","WAWebMsgKey","WAWebMsgType","WAWebNewsletterMsgEditUtils","WAWebUserPrefsMeUser","err"],(function(a,b,c,d,e,f,g){function a(a,b,e){if(e.addOnParentKey==null)throw c("err")("Reaction message without parent");return{id:a,reactionParentKey:e.addOnParentKey,type:d("WAWebMsgType").MSG_TYPE.REACTION,kind:d("WAWebMsgType").MsgKind.ReactionDecrypted,t:b.t,from:b.from,to:b.to,serverId:b.serverId,isNewMsg:!1,ack:d("WAAckLevel").ACK.SENT,read:!1,reactionText:b.reactionCode,reactionTimestamp:b.t*1e3}}function b(a,b,e){if(e.addOnParentKey==null)throw c("err")("Reaction message without parent");return{id:a,t:b.t,from:b.from,to:b.to,serverId:b.serverId,isNewMsg:!1,ack:d("WAAckLevel").ACK.SENT,type:d("WAWebMsgType").MSG_TYPE.POLL_UPDATE,kind:d("WAWebMsgType").MsgKind.PollVoteDecrypted,subtype:"poll_vote",pollUpdateParentKey:e.addOnParentKey,selectedOptionLocalIds:(a=e.pollVotesAsLocalIds)!=null?a:[],senderTimestampMs:b.t*1e3,read:!1}}function e(a){var b=a.msgKey,e=a.msg,f=a.msgContext,g=a.baseMsgData;a=a.parsingContext;if(a==="history"){return{id:new(c("WAWebMsgKey"))({remote:e.from,fromMe:e.isSender,id:e.id}),from:e.from,to:e.isSender?e.from:d("WAWebUserPrefsMeUser").getMeUser(),t:(a=f.metaOriginalMsgT)!=null?a:e.t,serverId:e.serverId,lastUpdateFromServerTs:(a=f.lastUpdateFromServerTs)!=null?a:void 0,type:"revoked",kind:d("WAWebMsgType").MsgKind.RevokedMessage,revokeSender:e.from,subtype:"admin"}}return babelHelpers["extends"]({},g,{serverId:e.serverId,id:new(c("WAWebMsgKey"))({remote:e.from,fromMe:e.isSender,id:c("WAWebMsgKey").newId_DEPRECATED()}),type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.ProtocolRevoke,subtype:"admin_revoke",protocolMessageKey:b})}function f(a,b,c){return b!=="history"?d("WAWebNewsletterMsgEditUtils").mapMsgToEditProtocolMsg(a,{latestEditSenderTimestampMs:c.latestEditSenderTimestampMs}):a}g.mapReactionMsgStanza=a;g.mapPollVoteMsgStanza=b;g.mapRevokeMsgStanza=e;g.mapEditMsgStanza=f}),98);
__d("WAWebNewsletterBackendMsgUtils",["WAAckLevel","WATimeUtils","WAWebE2EProtoParser","WAWebMsgKey","WAWebMsgType","WAWebNewsletterFutureProofUtils","WAWebNewsletterMsgStanzaAdapters","WAWebProtobufsE2E.pb","WAWebUserPrefsMeUser","decodeProtobuf","err"],(function(a,b,c,d,e,f,g){function h(a,b){var e=a.msg;a=a.msgContext;var f=new(c("WAWebMsgKey"))({remote:e.from,fromMe:e.isSender,id:e.id});switch(e.type){case"NewsletterReaction":case"NewsletterReactionRevoke":return d("WAWebNewsletterMsgStanzaAdapters").mapReactionMsgStanza(f,e,a);case"NewsletterPollVote":return d("WAWebNewsletterMsgStanzaAdapters").mapPollVoteMsgStanza(f,e,a)}var g=j(f,e);if(e.type==="NewsletterRevoke")return d("WAWebNewsletterMsgStanzaAdapters").mapRevokeMsgStanza({msgKey:f,msg:e,msgContext:a,baseMsgData:g,parsingContext:b});var h=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsE2E.pb").MessageSpec,e.payload);h=d("WAWebE2EProtoParser").parseMsgProto(h,g,b);g=i(babelHelpers["extends"]({},h,{isNewMsg:a.isNewMsg,viewCount:(g=a.viewCount)!=null?g:void 0,hasReaction:!!a.hasReaction,latestEditSenderTimestampMs:a.latestEditSenderTimestampMs,lastUpdateFromServerTs:(g=a.lastUpdateFromServerTs)!=null?g:void 0,latestEditMsgKey:a.isEdited===!0?f:void 0,serverId:e.serverId}));d("WAWebNewsletterFutureProofUtils").isMsgSupported(h)||(g.type=d("WAWebMsgType").MSG_TYPE.UNKNOWN,g.kind=d("WAWebMsgType").MsgKind.Unknown,g.futureproofType=h.type,g.futureproofSubtype=h.subtype);switch(e.type){case"NewsletterEdit":return d("WAWebNewsletterMsgStanzaAdapters").mapEditMsgStanza(g,b,a);case"NewsletterPollCreation":case"NewsletterText":case"NewsletterMedia":return g;default:e.type;throw c("err")("unreachable code")}}function i(a){a.streamingSidecar=null;a.mediaKey=null;a.mediaKeyTimestamp=null;return a}function a(a,b,c,e){c===void 0&&(c=!1);var f=a.newsletterMessageHistoryContent,g=a.id,i=a.t,j=a.serverId;if(f==null||g==null||i==null)return null;var k=a.isSender==="true";g={id:g,from:b,isSender:k,to:k?b:d("WAWebUserPrefsMeUser").getMeUser(),t:i,serverId:j,offline:!1};b=(k=a.newsletterMessageOriginalTimestampMixin)==null?void 0:k.metaOriginalMsgT;k={hasReaction:c,lastUpdateFromServerTs:e,viewCount:(j=a.newsletterViewsCountMixin)==null?void 0:j.viewsCountCount,isEdited:f.name==="NewsletterEdit",metaOriginalMsgT:b};c="history";switch(f.name){case"NewsletterEdit":j=(e=a.newsletterMessageLastEditTimestampMixin)==null?void 0:e.metaMsgEditT;a=j!=null?d("WATimeUtils").castToMillisTime(j):void 0;b=(e=b)!=null?e:i;return h({msg:babelHelpers["extends"]({},g,{type:f.name,t:b,payload:f.value.newsletterTextOrMediaMixinGroup.value.plaintextPayloadMixin.elementValue,msgEditT:j,msgOriginalT:i}),msgContext:babelHelpers["extends"]({},k,{latestEditSenderTimestampMs:a})},c);case"NewsletterText":return h({msg:babelHelpers["extends"]({},g,{payload:f.value.plaintextPayloadMixin.elementValue,type:f.name}),msgContext:k},c);case"NewsletterPollCreation":return h({msg:babelHelpers["extends"]({},g,{payload:f.value.plaintextPayloadMixin.elementValue,type:f.name}),msgContext:k},c);case"NewsletterMedia":return h({msg:babelHelpers["extends"]({},g,{payload:f.value.plaintextPayloadMixin.elementValue,type:f.name}),msgContext:k},c);case"NewsletterRevoke":return h({msg:babelHelpers["extends"]({},g,{type:f.name}),msgContext:k},c);default:f.name;return null}}function j(a,b){return{ack:d("WAAckLevel").ACK.SENT,from:b.from,t:b.t,to:b.to,id:a,type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,count:null,invis:!1}}g.mapMsgStanzaToMsgData=h;g.mapNewsletterMsgToMsgData=a}),98);
__d("WAWebNewsletterPollsVotesUtils",["WABase64","WAHex","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield self.crypto.subtle.digest("SHA-256",new TextEncoder().encode(a)));return d("WAHex").toHex(new Uint8Array(a))});return h.apply(this,arguments)}function c(a){return d("WAHex").toHex(a)}function e(a){return d("WAHex").toHex(new Uint8Array(d("WABase64").decodeB64(a))).toUpperCase()}g.getPollOptionHash=a;g.bufferToHex=c;g.base64ToHex=e}),98);